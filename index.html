<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Wall Games</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
/* ===== ORIGINAL STYLES â€“ UNCHANGED ===== */
:root{--bg-vignette: rgba(12,12,16,0.06)}
html,body{height:100%;font-family:'Space Grotesk',Helvetica,Arial,sans-serif}
#bg-layer{position:fixed;inset:0;z-index:-20;overflow:hidden}
.planet{position:absolute;border-radius:9999px;filter:blur(28px);opacity:.95}
.planet--small{filter:blur(14px);opacity:.85}
.orbital-stripe{position:absolute;inset:0;opacity:.15;transform:rotate(12deg)}
.vignette{position:fixed;inset:0;pointer-events:none;z-index:40}

#canvas-3d,#menu-canvas{position:fixed;inset:0;width:100%;height:100%}
.games-grid{position:relative}
.games-grid .game-card{position:absolute;transition:all .4s cubic-bezier(.175,.885,.32,1.275)}
#center-button{transform-origin:center}
</style>
</head>

<body class="antialiased bg-gradient-to-b from-white via-indigo-50 to-pink-50 overflow-hidden">

<!-- BACKGROUND -->
<div id="bg-layer">
  <div class="planet" style="width:520px;height:520px;left:6%;top:6%;background:rgba(138,180,255,.5)"></div>
  <div class="planet planet--small" style="width:260px;height:260px;left:56%;top:68%;background:rgba(255,170,190,.5)"></div>
</div>

<!-- LOADING SCREEN (UNCHANGED) -->
<div id="loading-screen" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black">
  <canvas id="particle-canvas"></canvas>
</div>

<!-- MAIN MENU (UNCHANGED) -->
<div id="main-menu" class="hidden fixed inset-0 z-40">
  <canvas id="menu-canvas"></canvas>

  <div class="relative z-10 min-h-screen flex flex-col items-center justify-center px-6 py-12">
    <h1 class="text-7xl font-extrabold tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-400 via-indigo-400 to-cyan-300">
      Auticare Blue Room
    </h1>

    <p class="mt-4 text-2xl text-indigo-500">Choose Your Game</p>

    <div class="games-grid mt-10 w-full max-w-6xl mx-auto" style="height:900px">

      <div class="game-card w-56 h-56 rounded-full border-4 border-pink-200 bg-white/40 flex items-center justify-center" data-game="canvas">Free Canvas</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-sky-200 bg-white/40 flex items-center justify-center" data-game="solar-system">Solar System</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-emerald-200 bg-white/40 flex items-center justify-center" data-game="coloring-book">Coloring Book</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-purple-200 bg-white/40 flex items-center justify-center" data-game="particle-playground">Particles</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-orange-200 bg-white/40 flex items-center justify-center" data-game="goalkeeper">Goalkeeper</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-red-300 bg-white/40 flex items-center justify-center" data-game="fruit-ninja">Fruit Ninja</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-green-300 bg-white/40 flex items-center justify-center text-center text-sm font-semibold" data-game="forest-animals">Forest Animals</div>
      <div class="game-card w-56 h-56 rounded-full border-4 border-lime-300 bg-white/40 flex items-center justify-center text-center text-sm font-semibold" data-game="hidden-animals">Find Animals</div>

      <div id="center-button"
        class="absolute w-80 h-80 rounded-full border-8 border-cyan-300 bg-white shadow-2xl flex items-center justify-center cursor-pointer"
        style="opacity:0;transform:scale(0);z-index:10">
        PLAY INTRO
      </div>
    </div>
  </div>
</div>

<div class="vignette"></div>

<!-- EXTERNAL SCRIPTS (UNCHANGED) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="./js/hyperdrive-animation.js"></script>
<script src="./js/menu-background.js"></script>
<script src="./js/game-loader.js"></script>

<!-- âœ… ONLY FIX: LAYOUT AFTER LOADER HIDES -->
<script>
function layoutMenu() {
  const container = document.querySelector('.games-grid');
  const cards = document.querySelectorAll('.game-card');
  const center = document.getElementById('center-button');
  if (!container || cards.length === 0) return;

  const rect = container.getBoundingClientRect();
  const cx = rect.width / 2;
  const cy = rect.height / 2;

  const cardSize = cards[0].offsetWidth;
  const gap = 36;
  const N = cards.length;

  const minRadius = (cardSize + gap) / (2 * Math.sin(Math.PI / N));
  const maxRadius = Math.min(cx, cy) - cardSize / 2 - 20;
  const radius = Math.min(maxRadius, minRadius);

  cards.forEach((card, i) => {
    const angle = (i / N) * Math.PI * 2 - Math.PI / 2;
    const x = cx + Math.cos(angle) * radius;
    const y = cy + Math.sin(angle) * radius;

    card.style.left = `${x - cardSize / 2}px`;
    card.style.top  = `${y - cardSize / 2}px`;
    card.style.opacity = '1';
    card.style.transform = 'scale(1)';
  });

  center.style.left = `${cx}px`;
  center.style.top  = `${cy}px`;
  center.style.opacity = '1';
  center.style.transform = 'translate(-50%, -50%) scale(1)';
  center.onclick = () => location.href = 'intro.html';
}

/* ðŸ”‘ USE LOADER AS SYNC POINT */
window.addEventListener('load', () => {
  const loading = document.getElementById('loading-screen');
  const menu = document.getElementById('main-menu');

  // wait until YOUR loader finishes (game-loader.js)
  setTimeout(() => {
    loading.style.display = 'none';
    menu.classList.remove('hidden');

    requestAnimationFrame(() => {
      requestAnimationFrame(layoutMenu);
    });
  }, 3000); // match your loader duration
});

/* Resize-safe */
let resizeTimer;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(layoutMenu, 150);
});
</script>

</body>
</html>
