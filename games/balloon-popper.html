<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Super Alphabet Sky Pop!</title>
<style>
:root {
  --pink: #ff007f;
  --yellow: #fff000;
  --blue: #00e5ff;
  --purple: #9d00ff;
  --sky: #4face6;
}

*{margin:0;padding:0;box-sizing:border-box;user-select:none;-webkit-user-select:none}
body{
    overflow:hidden; 
    font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif; 
    background: linear-gradient(to bottom, #4face6, #74ebd5);
    touch-action:none;
}

#gameCanvas{display:block; cursor:none; position: relative; z-index: 5;}

/* UI Styling */
.ui-top{position:absolute; top:20px; left:0; width:100%; pointer-events:none; z-index:10; display:flex; justify-content:center; gap:15px;}
.stat-item{
    background: white; padding: 10px 25px; border-radius: 50px;
    box-shadow: 0 6px 0 rgba(0,0,0,0.1); border: 4px solid var(--pink);
    text-align: center;
}
.stat-label{font-size:12px; font-weight:900; color: #444; text-transform:uppercase;}
.stat-value{font-size:32px; font-weight:900; color: var(--pink);}

/* Pop Effects */
.floating-letter {
    position: absolute; pointer-events: none; font-weight: 900; font-size: 55px;
    z-index: 50; text-shadow: 3px 3px 0 white;
    animation: bouncePop 0.7s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
}
@keyframes bouncePop {
    0% { transform: scale(0) rotate(-20deg); opacity: 0; }
    50% { opacity: 1; transform: scale(1.4) rotate(10deg); }
    100% { opacity: 0; transform: scale(1) translateY(-120px); }
}

/* Screens */
.screen {
    position: absolute; inset: 0; display: flex; flex-direction: column; 
    align-items: center; justify-content: center;
    background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(79, 172, 230, 0.8));
    backdrop-filter: blur(8px); z-index: 100; text-align: center; padding: 20px;
}
.title-card h1 { 
    font-size: 65px; color: var(--pink); line-height: 1;
    text-shadow: 4px 4px 0px white, 8px 8px 20px rgba(0,0,0,0.2);
    margin-bottom: 20px;
}
.btn {
    padding: 20px 60px; font-size: 32px; font-weight: 900;
    background: #00ff88; color: #004400; border: none;
    border-radius: 100px; cursor: pointer; border-bottom: 8px solid #009955;
}
.btn:active { transform: translateY(4px); border-bottom-width: 4px; }

.modes { display: flex; gap: 15px; margin-bottom: 30px; }
.m-btn { 
    padding: 15px 25px; background: white; border: 3px solid var(--sky);
    border-radius: 20px; color: var(--sky); cursor: pointer; font-weight: bold; font-size: 18px;
}
.m-btn.active { background: var(--pink); border-color: white; color: white; transform: scale(1.1); }

.cloud {
    position: absolute; background: white; border-radius: 100px; opacity: 0.6; z-index: 1;
    animation: moveClouds linear infinite;
}
@keyframes moveClouds { from { transform: translateX(-250px); } to { transform: translateX(calc(100vw + 250px)); } }
</style>
</head>
<body>

<div id="startScreen" class="screen">
    <h1>SKY POP!</h1>
    <div class="modes">
        <button class="m-btn active" onclick="setMode('english')">ABC English</button>
        <button class="m-btn" onclick="setMode('malayalam')">à´®à´²à´¯à´¾à´³à´‚</button>
    </div>
    <button class="btn" onclick="initGame()">START!</button>
</div>

<div id="gameOverScreen" class="screen" style="display:none">
    <h1 style="color: var(--pink);">GREAT JOB!</h1>
    <p id="finalScoreMsg" style="font-size: 40px; color: #333; font-weight: 900; margin-bottom: 20px;">0 Pops!</p>
    <button class="btn" onclick="location.reload()">PLAY AGAIN</button>
</div>

<div class="cloud" style="width:150px; height:50px; top:10%; animation-duration: 25s;"></div>
<div class="cloud" style="width:200px; height:70px; top:30%; animation-duration: 40s; animation-delay: -5s;"></div>
<div class="cloud" style="width:120px; height:40px; top:60%; animation-duration: 30s; animation-delay: -15s;"></div>

<div class="ui-top">
    <div class="stat-item">
        <div class="stat-label">POPS</div>
        <div id="scoreDisplay" class="stat-value">0</div>
    </div>
    <div class="stat-item">
        <div class="stat-label">TIME</div>
        <div id="timerDisplay" class="stat-value">60</div>
    </div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('scoreDisplay');
const timerEl = document.getElementById('timerDisplay');

let width, height, score = 0, timeLeft = 60;
let gameActive = false, currentMode = 'english';
let balloons = [], particles = [], slicePath = [];

const english = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
const malayalam = "à´…à´†à´‡à´ˆà´‰à´Šà´‹à´Žà´à´à´’à´“à´”à´•à´–à´—à´˜à´™à´šà´›à´œà´à´žà´Ÿà´ à´¡à´¢à´£à´¤à´¥à´¦à´§à´¨à´ªà´«à´¬à´­à´®à´¯à´°à´±à´²à´³à´´à´µà´¶à´·à´¸à´¹".split("");
const kidColors = ['#FF007F', '#00E5FF', '#FFEF00', '#00FF88', '#FF9100', '#9D00FF', '#FF3333'];

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(freq, type, duration, vol=0.1) {
    if (!audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(freq/2, audioCtx.currentTime + duration);
    gain.gain.setValueAtTime(vol, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.start(); osc.stop(audioCtx.currentTime + duration);
}

function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

function setMode(m) {
    currentMode = m;
    document.querySelectorAll('.m-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
}

class Balloon {
    constructor() {
        this.radius = 45 + Math.random() * 15;
        this.x = Math.random() * (width - 100) + 50;
        this.y = height + 100;
        this.vx = (Math.random() - 0.5) * 1.5;
        this.vy = -(2.5 + Math.random() * 2.5); // VERY SLOW
        this.color = kidColors[Math.floor(Math.random() * kidColors.length)];
        const list = currentMode === 'english' ? english : malayalam;
        this.letter = list[Math.floor(Math.random() * list.length)];
        this.isBomb = Math.random() < 0.12;
        this.popped = false;
        this.wobble = Math.random() * 10;
    }
    update() {
        this.y += this.vy;
        this.x += this.vx + Math.sin(this.wobble) * 0.5;
        this.wobble += 0.05;
        return this.y < -150 || this.popped;
    }
    draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.beginPath();
        ctx.fillStyle = this.isBomb ? '#FFD700' : this.color;
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 5;
        ctx.ellipse(0, 0, this.radius * 0.9, this.radius, 0, 0, Math.PI * 2);
        ctx.fill(); ctx.stroke();
        // Shine
        ctx.beginPath(); ctx.fillStyle = 'rgba(255,255,255,0.3)';
        ctx.ellipse(-this.radius/3, -this.radius/3, 10, 15, Math.PI/4, 0, Math.PI*2); ctx.fill();
        // Letter
        ctx.fillStyle = 'white';
        ctx.font = `bold ${this.radius * 0.8}px Arial`;
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.fillText(this.isBomb ? 'ðŸŽ' : this.letter, 0, 0);
        ctx.restore();
    }
}

class Particle {
    constructor(x, y, color) {
        this.x = x; this.y = y; this.color = color;
        this.vx = (Math.random() - 0.5) * 14;
        this.vy = (Math.random() - 0.5) * 14;
        this.alpha = 1;
    }
    update() { this.x += this.vx; this.y += this.vy; this.alpha -= 0.02; this.vy += 0.1;}
    draw() {
        ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
        ctx.beginPath(); ctx.arc(this.x, this.y, 6, 0, Math.PI*2); ctx.fill();
        ctx.globalAlpha = 1;
    }
}

function spawnFloatingText(x, y, text, color) {
    const el = document.createElement('div');
    el.className = 'floating-letter';
    el.style.left = x + 'px'; el.style.top = y + 'px';
    el.style.color = color; el.innerText = text;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 700);
}

function initGame() {
    audioCtx.resume();
    document.getElementById('startScreen').style.display = 'none';
    gameActive = true;
    
    // MASSIVE BALLOON COUNT (Spawn every 300ms + random doubles)
    setInterval(() => {
        if(!gameActive) return;
        balloons.push(new Balloon());
        if(Math.random() > 0.4) balloons.push(new Balloon()); 
    }, 350);

    setInterval(() => {
        if(!gameActive) return;
        timeLeft--;
        timerEl.innerText = timeLeft;
        if(timeLeft <= 0) endGame();
    }, 1000);
    loop();
}

function endGame() {
    gameActive = false;
    playSound(400, 'triangle', 0.6, 0.2);
    document.getElementById('gameOverScreen').style.display = 'flex';
    document.getElementById('finalScoreMsg').innerText = score + " Pops!";
}

function loop() {
    if(!gameActive) return;
    ctx.clearRect(0,0,width,height);

    // Rainbow Trail
    if (slicePath.length > 1) {
        for(let i=1; i<slicePath.length; i++){
            ctx.beginPath();
            ctx.strokeStyle = kidColors[i % kidColors.length];
            ctx.lineWidth = 12 * (i/slicePath.length);
            ctx.lineCap = 'round';
            ctx.moveTo(slicePath[i-1].x, slicePath[i-1].y);
            ctx.lineTo(slicePath[i].x, slicePath[i].y);
            ctx.stroke();
        }
    }

    balloons = balloons.filter(b => {
        const off = b.update();
        b.draw();
        return !off;
    });

    particles = particles.filter(p => {
        p.update(); p.draw();
        return p.alpha > 0;
    });

    requestAnimationFrame(loop);
}

const handleMove = (x, y) => {
    if(!gameActive) return;
    slicePath.push({x, y});
    if(slicePath.length > 12) slicePath.shift();

    balloons.forEach(b => {
        if(!b.popped && Math.hypot(b.x - x, b.y - y) < b.radius) {
            b.popped = true;
            if(b.isBomb) {
                playSound(600, 'triangle', 0.5, 0.2);
                spawnFloatingText(b.x, b.y, "ðŸŽ WOW!", "#FFF");
            } else {
                score++;
                scoreEl.innerText = score;
                playSound(300 + Math.random() * 200, 'sine', 0.15, 0.1);
                spawnFloatingText(b.x, b.y, b.letter, b.color);
            }
            for(let i=0; i<15; i++) particles.push(new Particle(b.x, b.y, b.color));
        }
    });
};

canvas.addEventListener('mousemove', e => handleMove(e.clientX, e.clientY));
canvas.addEventListener('touchmove', e => {
    e.preventDefault();
    handleMove(e.touches[0].clientX, e.touches[0].clientY);
}, {passive: false});
canvas.addEventListener('touchend', () => slicePath = []);

</script>
</body>
</html>