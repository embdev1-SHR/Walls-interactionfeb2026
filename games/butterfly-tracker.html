<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Butterfly Haven ‚Äì Endless Flutter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
        }
        
        body {
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            /* PERMANENT DAY THEME ‚Äì bright & cheerful */
            background: linear-gradient(180deg, #87CEEB 0%, #B0E57C 40%, #5F9F4F 100%);
            color: white;
            height: 100vh;
            width: 100vw;
            position: relative;
            touch-action: none;
        }
        
        /* Environment ‚Äì sunny meadow */
        .cloud {
            position: absolute;
            opacity: 0.75;
            z-index: 1;
            filter: drop-shadow(0 10px 15px rgba(255,255,255,0.3));
            animation: floatCloud 90s infinite alternate;
        }
        .cloud:nth-child(1) { top: 12%; left: 2%; width: 190px; animation-duration: 110s; }
        .cloud:nth-child(2) { top: 22%; right: 5%; width: 230px; animation-duration: 130s; }
        .cloud:nth-child(3) { top: 8%; left: 45%; width: 200px; animation-duration: 100s; }
        .cloud:nth-child(4) { top: 40%; left: 15%; width: 160px; opacity: 0.5; }
        
        @keyframes floatCloud {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(50px) translateY(20px); }
        }
        
        .lake {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 200px;
            z-index: 2;
            filter: brightness(1.15) saturate(1.2);
            object-fit: cover;
        }
        
        /* UI ‚Äì only score, no timers/lives */
        .game-ui {
            position: absolute;
            top: 24px;
            left: 0;
            width: 100%;
            pointer-events: none;
            z-index: 100;
        }
        .stats {
            display: flex;
            justify-content: flex-start;
            padding: 0 40px;
        }
        .stat-item {
            background: rgba(255, 248, 200, 0.4);
            backdrop-filter: blur(12px);
            padding: 16px 42px;
            border-radius: 50px;
            border: 2px solid rgba(255, 255, 150, 0.7);
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
        }
        .stat-label {
            font-size: 15px;
            font-weight: 700;
            color: #2D5E2C;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        .stat-value {
            font-size: 56px;
            font-weight: 900;
            color: #FFE55C;
            text-shadow: 4px 4px 0 #CC8B1F, 0 0 25px #FFD700;
            line-height: 1;
        }
        
        /* Start Screen ‚Äì fresh day style */
        .start-screen {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(135, 206, 235, 0.75);
            backdrop-filter: blur(10px);
            z-index: 200;
            pointer-events: auto;
        }
        .start-title {
            font-size: 80px;
            font-weight: 900;
            color: #FFF9C4;
            text-shadow: 6px 6px 0 #6B8E23, 0 0 40px #FFD700;
            margin-bottom: 20px;
        }
        .start-subtitle {
            font-size: 28px;
            color: #1F4F2B;
            background: rgba(255,255,220,0.7);
            padding: 20px 40px;
            border-radius: 60px;
            backdrop-filter: blur(4px);
            margin-bottom: 60px;
            font-weight: 600;
        }
        .start-btn {
            padding: 24px 90px;
            font-size: 40px;
            font-weight: 800;
            background: linear-gradient(145deg, #FFE55C, #FFB347);
            color: #2D5E2C;
            border: none;
            border-radius: 80px;
            cursor: pointer;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: gentlePulse 2.5s infinite;
            display: flex;
            align-items: center;
            gap: 20px;
            pointer-events: auto;
            border: 3px solid white;
        }
        @keyframes gentlePulse { 50% { transform: scale(1.06); } }
        
        /* Game Over */
        .game-over {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 245, 200, 0.95);
            backdrop-filter: blur(16px);
            padding: 60px 80px;
            border-radius: 60px;
            text-align: center;
            border: 6px solid #FFD700;
            box-shadow: 0 0 70px #FFB347;
            display: none;
            z-index: 300;
            width: 90%;
            max-width: 750px;
        }
        .game-over.show { display: block; }
        .game-over h1 { font-size: 58px; color: #C45A2C; }
        .final-score { font-size: 56px; color: #3F7841; margin: 15px 0; }
        .high-score { font-size: 34px; color: #B8860B; }
        .go-btn {
            padding: 18px 48px;
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(145deg, #FFE484, #FFAA33);
            color: #2C5E2C;
            border: none;
            border-radius: 50px;
            margin: 12px;
            cursor: pointer;
            transition: 0.1s;
            border: 2px solid white;
        }
        .go-btn:active { transform: scale(0.92); }
        
        /* Game area */
        .game-area {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 15;
        }
        
        /* Visual pop */
        .catch-effect {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 150;
            display: none;
        }
        .catch-effect.active {
            display: block;
            animation: sunFlash 0.5s;
        }
        @keyframes sunFlash { 0% { background: rgba(255, 235, 120, 0.3); } }
        
        .combo-display {
            position: absolute;
            top: 35%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 85px;
            font-weight: 900;
            color: #FFF0A0;
            text-shadow: 5px 5px 0 #B87333, 0 0 35px gold;
            pointer-events: none;
            z-index: 80;
            animation: comboRise 1.2s forwards;
        }
        @keyframes comboRise {
            0% { opacity: 0; transform: translate(-50%, -30%) scale(0.3); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.3); }
            100% { opacity: 0; transform: translate(-50%, -120%) scale(0.8); }
        }
        
        .pop-effect {
            position: absolute;
            border: 5px solid #FFE873;
            border-radius: 50%;
            pointer-events: none;
            z-index: 120;
            animation: popRing 0.65s forwards;
            box-shadow: 0 0 25px gold;
        }
        @keyframes popRing {
            0% { width: 15px; height: 15px; opacity: 1; }
            100% { width: 220px; height: 220px; opacity: 0; }
        }
        
        .points-display {
            position: absolute;
            font-size: 44px;
            font-weight: 900;
            color: #FFE484;
            text-shadow: 3px 3px 0 #B45F1B, 0 0 30px #FFB347;
            pointer-events: none;
            z-index: 110;
            animation: floatPoints 1s forwards;
        }
        @keyframes floatPoints {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
            100% { transform: translate(-50%, -120%) scale(1.2); opacity: 0; }
        }
        
        /* ----- BUTTERFLY STYLES (preserved & improved) ----- */
        .butterfly_container {
            position: absolute;
            cursor: pointer;
            pointer-events: auto;
            z-index: 60;
            will-change: transform, left, top;
            transition: transform 0.05s; /* micro-smoothing */
        }
        .butterfly_container.caught {
            animation: vanish 0.6s forwards;
        }
        @keyframes vanish {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        /* flapping & floating ‚Äì refined, gentle */
        @keyframes gentleFloat {
            0%, 100% { transform: translate3d(0, 0, 0); }
            25% { transform: translate3d(0, 25px, 0); }
            75% { transform: translate3d(0, -15px, 0); }
        }
        
        @keyframes leftWingBeat {
            0%, 100% { transform: translate3d(0,0,0) scaleX(1) rotate3d(0,1,0, 40deg); }
            50% { transform: translate3d(0,0,0) scaleX(1) rotate3d(0,1,0, -40deg); }
        }
        @keyframes rightWingBeat {
            0%, 100% { transform: translate3d(0,0,0) scaleX(-1) rotate3d(0,1,0, 40deg); }
            50% { transform: translate3d(0,0,0) scaleX(-1) rotate3d(0,1,0, -40deg); }
        }
        
        .butterfly_container var {
            position: absolute;
            left: 50%; top: 50%;
            width: 100px; height: 100px;
            margin-left: -50px; margin-top: -50px;
            transform-style: preserve-3d;
            animation: gentleFloat 8s ease-in-out infinite;
        }
        
        .butterfly_container figure.butterfly {
            position: absolute;
            width: 100px; height: 100px;
            transform-style: preserve-3d;
        }
        
        .butterfly_container .wing {
            position: absolute;
            width: 50px; height: 100px;
            transform-style: preserve-3d;
        }
        .butterfly_container .wing.left {
            transform-origin: 50px 50px;
            animation: leftWingBeat 0.9s ease-in-out infinite;
        }
        .butterfly_container .wing.right {
            transform-origin: 50px 50px;
            transform: scaleX(-1);
            animation: rightWingBeat 0.9s ease-in-out infinite;
        }
        
        .svg-defs { position: absolute; width: 0; height: 0; }
    </style>
</head>
<body>
    <!-- DAY THEME only ‚Äì static sunny environment -->
    <img src="https://i.postimg.cc/sXvPDVnC/4.png" alt="cloud" class="cloud" />
    <img src="https://i.postimg.cc/sXvPDVnC/4.png" alt="cloud" class="cloud" />
    <img src="https://i.postimg.cc/sXvPDVnC/4.png" alt="cloud" class="cloud" />
    <img src="https://i.postimg.cc/sXvPDVnC/4.png" alt="cloud" class="cloud" />
    <img src="https://i.postimg.cc/sXvPDVTc/1.png" alt="meadow" class="lake" />
    
    <!-- GAME AREA -->
    <div class="game-area" id="gameArea"></div>
    
    <!-- START SCREEN -->
    <div class="start-screen" id="startScreen">
        <h1 class="start-title">ü¶ã BUTTERFLY HAVEN ü¶ã</h1>
        <p class="start-subtitle">‚òÄÔ∏è endless sunny meadow ‚Ä¢ 50+ fluttering friends ‚òÄÔ∏è</p>
        <button class="start-btn" id="startBtn"><i class="fas fa-play"></i> BEGIN</button>
    </div>
    
    <!-- SCORE UI (only score) -->
    <div class="game-ui">
        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">CATCHED</div>
                <div class="stat-value" id="scoreDisplay">0</div>
            </div>
        </div>
    </div>
    
    <!-- Effects -->
    <div class="catch-effect" id="catchEffect"></div>
    
    <!-- GAME OVER -->
    <div class="game-over" id="gameOver">
        <h1>‚ú® BUTTERFLY DANCE ‚ú®</h1>
        <div class="final-score">Score: <span id="finalScore">0</span></div>
        <div class="high-score" id="highScore">High Score: 0</div>
        <div>
            <button class="go-btn" id="playAgainBtn">Play again</button>
            <button class="go-btn" id="menuBtn">Menu</button>
        </div>
    </div>
    
    <!-- SVG wing shape -->
    <svg class="svg-defs">
        <defs>    
            <g id="shape-moth">
                <path style="fill:currentColor;" d="M2.457,32.759c6.752,15.757,12.862,9.004,19.615,31.513
                     c4.96,16.533,12.703,21.434,25.763,19.562c-8.291,5.666-11.245,14.512-2.29,30.097c10.611,18.467,29.262,32.338,38.587,34.268
                     s19.615-6.431,21.866-18.328c2.251-11.898,3.216-13.185,11.255-50.485V66.202v-8.039c0,0-44.054-38.266-73.637-42.767
                     C14.033,10.894-4.296,17.003,2.457,32.759z"/>
            </g>
        </defs>
    </svg>

    <script>
        (function(){
            "use strict";

            // ---- GAME STATE - NO TIMER, NO LIVES, NO NIGHT MODE ----
            let score = 0;
            let gameRunning = false;
            let butterflies = [];
            let combo = 0;
            let comboTimer = 0;
            let highScore = localStorage.getItem('butterflyHighScore') || 0;
            let spawnInterval = null;
            let animationFrame = null;
            
            // ---------- MULTI‚ÄëCOLOR PALETTE (vivid) ----------
            const colorPalette = [
                '#FF6B8B', '#A8FF78', '#78D6FF', '#FFB27F', '#D28AFF',
                '#7AFFB3', '#FF88C2', '#6BC5FF', '#FFDE7A', '#FF9966',
                '#C27EFF', '#7FFFD4', '#FF96C0', '#C1FF72', '#FFB347',
                '#FF6EC7', '#00E5E5', '#FFA07A', '#DA70D6', '#FFD570',
                '#FF8C69', '#B0E57C', '#FFA54B', '#CD96CD', '#FFB38B',
                '#97F0B0', '#FFAAAA', '#BFFF00', '#FF7F82', '#E0B0FF'
            ];
            
            // each butterfly gets 2-5 random colors
            function getButterflyColors() {
                const count = Math.floor(Math.random() * 4) + 2; // 2-5 colors
                const shuffled = [...colorPalette].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, count);
            }

            // ---------- DOM ----------
            const gameArea = document.getElementById('gameArea');
            const startScreen = document.getElementById('startScreen');
            const startBtn = document.getElementById('startBtn');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const gameOverScreen = document.getElementById('gameOver');
            const finalScoreEl = document.getElementById('finalScore');
            const highScoreEl = document.getElementById('highScore');
            const playAgainBtn = document.getElementById('playAgainBtn');
            const menuBtn = document.getElementById('menuBtn');
            const catchEffect = document.getElementById('catchEffect');

            // init highscore display
            highScoreEl.textContent = `High Score: ${highScore}`;

            // ----- REMOVED ALL DAY/NIGHT TOGGLES ‚Äì PERMANENT SUNNY -----

            // ----- GAME CORE -----
            function startGame() {
                gameRunning = true;
                score = 0;
                combo = 0;
                comboTimer = 0;
                updateScore();
                
                // clear any remaining butterflies
                butterflies.forEach(b => b.element?.remove());
                butterflies = [];
                
                startScreen.style.display = 'none';
                gameOverScreen.classList.remove('show');
                
                // SPAWN MANY BUTTERFLIES ‚Äì high density
                if (spawnInterval) clearInterval(spawnInterval);
                spawnInterval = setInterval(spawnButterfly, 320); // fast spawn ‚Üí lots of butterflies
                
                // initial burst: 18 butterflies instantly for rich meadow
                for (let i = 0; i < 18; i++) {
                    setTimeout(() => spawnButterfly(), i * 40);
                }
            }

            // ----- SPAWN BUTTERFLY ‚Äì smooth movement, natural paths -----
            function spawnButterfly() {
                if (!gameRunning) return;
                
                const container = document.createElement('div');
                container.className = 'butterfly_container';
                
                // start gently from edges
                const side = Math.floor(Math.random() * 3);
                let x, y;
                if (side === 0) { x = -60 - Math.random() * 40; y = Math.random() * window.innerHeight; }
                else if (side === 1) { x = Math.random() * window.innerWidth; y = -60 - Math.random() * 40; }
                else { x = window.innerWidth + 60 + Math.random() * 40; y = Math.random() * window.innerHeight; }
                
                container.style.left = `${x}px`;
                container.style.top = `${y}px`;
                
                // size variety
                const scale = Math.random() * 0.7 + 0.6; // 0.6‚Äì1.3
                container.style.transform = `scale(${scale})`;
                
                // ----- MULTI COLOR APPLICATION (vivid, each wing different) -----
                const colors = getButterflyColors();
                
                container.innerHTML = `
                    <var style="animation: gentleFloat ${9 + Math.random()*6}s infinite;">
                        <figure class="butterfly">
                            <svg class="wing left" viewBox="0 0 119.744 148.477">
                                <use xlink:href="#shape-moth" class="wing-left-fill"></use>
                            </svg> 
                            <svg class="wing right" viewBox="0 0 119.744 148.477">
                                <use xlink:href="#shape-moth" class="wing-right-fill"></use>
                            </svg> 
                        </figure>
                    </var>
                `;
                
                const leftWing = container.querySelector('.wing-left-fill');
                const rightWing = container.querySelector('.wing-right-fill');
                
                if (leftWing) {
                    leftWing.style.fill = colors[0] || '#FFA07A';
                    // add extra color accent using 'color' property for gradient-like
                    leftWing.style.color = colors[1] || colors[0];
                }
                if (rightWing) {
                    rightWing.style.fill = colors[1] || colors[0] || '#FFB27F';
                    rightWing.style.color = colors[2] || colors[0];
                }
                
                // shimmer effect: subtle glow
                const glowColor = colors[Math.floor(Math.random() * colors.length)];
                container.style.filter = `drop-shadow(0 0 7px ${glowColor}80)`;
                
                // ----- MOVEMENT PARAMETERS ‚Äì completely redesigned: smooth, floating, no crazy wobble -----
                // target is a random point inside view
                const targetX = Math.random() * (window.innerWidth - 200) + 100;
                const targetY = Math.random() * (window.innerHeight - 200) + 100;
                
                // gentle speed ‚Äì much slower and natural
                const baseSpeed = Math.random() * 0.9 + 0.5; // 0.5 - 1.4
                
                // store butterfly data
                const butterfly = {
                    element: container,
                    x, y,
                    targetX, targetY,
                    speed: baseSpeed,
                    angle: Math.atan2(targetY - y, targetX - x),
                    rotation: Math.random() * 360,
                    rotationSpeed: (Math.random() - 0.5) * 1.2, // very slow rotation
                    floatPhase: Math.random() * 100,
                    floatSpeed: 0.02 + Math.random() * 0.03,
                    floatAmount: 0.6 + Math.random() * 1.2, // subtle vertical drift
                    time: 0,
                    colors: colors
                };
                
                container.addEventListener('click', catchButterfly);
                container.addEventListener('touchstart', catchButterfly, { passive: false });
                
                gameArea.appendChild(container);
                butterflies.push(butterfly);
                
                // butterflies live longer (35s) then fade ‚Äì but we keep high count
                setTimeout(() => {
                    if (container.parentNode && gameRunning) {
                        container.remove();
                        butterflies = butterflies.filter(b => b.element !== container);
                    }
                }, 35000);
            }

            // ----- CATCH -----
            function catchButterfly(e) {
                if (!gameRunning) return;
                e.preventDefault();
                e.stopPropagation();
                
                const el = e.currentTarget;
                const butterfly = butterflies.find(b => b.element === el);
                if (!butterfly) return;
                
                const rect = el.getBoundingClientRect();
                const cx = rect.left + rect.width/2;
                const cy = rect.top + rect.height/2;
                
                // combo & points
                combo++;
                comboTimer = 55;
                const bonus = (combo >= 3) ? combo * 3 : 0;
                const points = 10 + bonus;
                score += points;
                updateScore();
                
                // vanish animation
                el.classList.add('caught');
                
                // pop effect
                const pop = document.createElement('div');
                pop.className = 'pop-effect';
                pop.style.left = `${cx}px`;
                pop.style.top = `${cy}px`;
                document.body.appendChild(pop);
                setTimeout(() => pop.remove(), 650);
                
                const pts = document.createElement('div');
                pts.className = 'points-display';
                pts.textContent = `+${points}`;
                pts.style.left = `${cx}px`;
                pts.style.top = `${cy}px`;
                document.body.appendChild(pts);
                setTimeout(() => pts.remove(), 1000);
                
                if (combo >= 3) {
                    const comboDiv = document.createElement('div');
                    comboDiv.className = 'combo-display';
                    comboDiv.textContent = `${combo}x COMBO!`;
                    document.body.appendChild(comboDiv);
                    setTimeout(() => comboDiv.remove(), 1200);
                }
                
                catchEffect.classList.add('active');
                setTimeout(() => catchEffect.classList.remove('active'), 400);
                
                // remove from arrays
                butterflies = butterflies.filter(b => b.element !== el);
                setTimeout(() => el.remove(), 600);
            }

            // ----- SMOOTH MOVEMENT ‚Äì natural, gentle, NO CRAZY WOBBLE -----
            function animateButterflies() {
                if (!gameRunning) {
                    animationFrame = requestAnimationFrame(animateButterflies);
                    return;
                }
                
                for (let b of butterflies) {
                    b.time++;
                    
                    // ---- calm, elegant pathfinding ----
                    const dx = b.targetX - b.x;
                    const dy = b.targetY - b.y;
                    const dist = Math.hypot(dx, dy);
                    
                    if (dist < 15) {
                        // new random destination ‚Äì within view
                        b.targetX = Math.random() * (window.innerWidth - 240) + 120;
                        b.targetY = Math.random() * (window.innerHeight - 200) + 100;
                    }
                    
                    // compute direction with slight randomness (very light)
                    const angleToTarget = Math.atan2(b.targetY - b.y, b.targetX - b.x);
                    // add minimal wandering (1D noise) ‚Äì but keep graceful
                    const randomTurn = (Math.random() - 0.5) * 0.15;
                    const moveAngle = angleToTarget + randomTurn;
                    
                    // move smoothly
                    b.x += Math.cos(moveAngle) * b.speed;
                    b.y += Math.sin(moveAngle) * b.speed;
                    
                    // gentle vertical floating (sinusoidal lift)
                    b.floatPhase += b.floatSpeed;
                    const floatOffset = Math.sin(b.floatPhase) * b.floatAmount;
                    b.y += floatOffset * 0.15; // subtle bobbing
                    
                    // very slow rotation, barely noticeable ‚Äì adds life
                    b.rotation += b.rotationSpeed;
                    if (b.rotation > 360) b.rotation -= 360;
                    if (b.rotation < 0) b.rotation += 360;
                    
                    // edge soft respawn ‚Äì if too far outside, reposition gently
                    if (b.x < -200) b.x = window.innerWidth + 50;
                    if (b.x > window.innerWidth + 200) b.x = -50;
                    if (b.y < -200) b.y = window.innerHeight + 50;
                    if (b.y > window.innerHeight + 200) b.y = -50;
                    
                    // apply transform ‚Äì clean, with tiny scale pulse for life
                    const pulse = 1 + Math.sin(b.time * 0.1) * 0.03;
                    b.element.style.left = `${b.x}px`;
                    b.element.style.top = `${b.y}px`;
                    b.element.style.transform = `translate(-50%, -50%) rotate(${b.rotation}deg) scale(${pulse})`;
                }
                
                // combo timer decay
                if (comboTimer > 0) {
                    comboTimer--;
                    if (comboTimer === 0) combo = 0;
                }
                
                animationFrame = requestAnimationFrame(animateButterflies);
            }

            function updateScore() {
                scoreDisplay.textContent = score;
            }

            // ----- END / MENU -----
            function endGame() {
                gameRunning = false;
                if (spawnInterval) clearInterval(spawnInterval);
                
                finalScoreEl.textContent = score;
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('butterflyHighScore', highScore);
                    highScoreEl.innerHTML = `üèÜ NEW HIGH: ${highScore}`;
                } else {
                    highScoreEl.textContent = `High Score: ${highScore}`;
                }
                gameOverScreen.classList.add('show');
            }

            function returnToMenu() {
                gameRunning = false;
                if (spawnInterval) clearInterval(spawnInterval);
                butterflies.forEach(b => b.element?.remove());
                butterflies = [];
                startScreen.style.display = 'flex';
                gameOverScreen.classList.remove('show');
                score = 0; combo = 0;
                updateScore();
            }

            function restartGame() {
                gameOverScreen.classList.remove('show');
                startGame();
            }

            // ----- EVENT LISTENERS -----
            startBtn.addEventListener('click', startGame);
            startBtn.addEventListener('touchstart', (e) => { e.preventDefault(); startGame(); }, { passive: false });
            
            playAgainBtn.addEventListener('click', restartGame);
            playAgainBtn.addEventListener('touchstart', (e) => { e.preventDefault(); restartGame(); });
            
            menuBtn.addEventListener('click', returnToMenu);
            menuBtn.addEventListener('touchstart', (e) => { e.preventDefault(); returnToMenu(); });

            // prevent page zoom on tap
            document.addEventListener('touchstart', (e) => {
                if (gameRunning && e.target.closest('.butterfly_container')) e.preventDefault();
            }, { passive: false });

            // resize adjustment
            window.addEventListener('resize', () => {
                butterflies.forEach(b => {
                    if (b.x > window.innerWidth + 100) b.x = window.innerWidth - 150;
                    if (b.y > window.innerHeight + 100) b.y = window.innerHeight - 150;
                });
            });

            // start animation
            animateButterflies();
        })();
    </script>
</body>
</html>