<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fish Catcher - Underwater Adventure</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
        }
        
        body {
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
            height: 100vh;
            width: 100vw;
            position: relative;
            touch-action: none;
        }
        
        /* Canvas Background */
        #canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        /* Game UI */
        .game-ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }
        
        .ui-top {
            width: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            padding: 20px 40px;
        }
        
        .stat-item {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px 30px;
            border-radius: 20px;
            backdrop-filter: blur(8px);
            border: 2px solid rgba(255, 255, 255, 0.15);
            min-width: 180px;
        }
        
        .stat-label {
            font-size: 14px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: #4fc3f7;
            text-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
        }
        
        .timer {
            color: #ffd700;
        }
        
        .lives {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .heart {
            font-size: 32px;
            filter: drop-shadow(1px 1px 3px rgba(0, 0, 0, 0.5));
            transition: all 0.3s;
            color: #ff6b6b;
        }
        
        /* Start Screen */
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(55, 59, 68, 0.85);
            backdrop-filter: blur(5px);
            z-index: 200;
            pointer-events: auto;
        }
        
        .start-title {
            font-size: 72px;
            font-weight: 900;
            color: #4fc3f7;
            text-shadow: 0 0 20px rgba(79, 195, 247, 0.7);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .start-subtitle {
            font-size: 24px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 60px;
            text-align: center;
            max-width: 800px;
            line-height: 1.5;
        }
        
        .start-btn {
            padding: 25px 80px;
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #4fc3f7, #0288d1);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            animation: pulse 2s ease-in-out infinite;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .start-btn:active {
            transform: scale(0.95);
        }
        
        .instructions {
            position: absolute;
            bottom: 100px;
            width: 100%;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            pointer-events: none;
        }
        
        /* Game Over Screen */
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.92);
            padding: 50px 70px;
            border-radius: 24px;
            text-align: center;
            border: 4px solid #4fc3f7;
            box-shadow: 0 0 40px rgba(79, 195, 247, 0.4);
            display: none;
            z-index: 300;
            pointer-events: auto;
            width: 90%;
            max-width: 700px;
        }
        
        .game-over.show {
            display: block;
        }
        
        .game-over h1 {
            font-size: 52px;
            color: #ff6b6b;
            margin-bottom: 16px;
        }
        
        .final-score {
            font-size: 40px;
            color: #4fc3f7;
            margin: 16px 0;
        }
        
        .high-score {
            font-size: 28px;
            color: #ffd700;
            margin-bottom: 30px;
        }
        
        .go-btn {
            margin-top: 20px;
            padding: 18px 50px;
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #4fc3f7, #0288d1);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            pointer-events: auto;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        .go-btn:active {
            transform: scale(0.95);
        }
        
        .go-btn + .go-btn {
            margin-left: 12px;
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        /* Interactive Fish Layer */
        .game-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20;
            pointer-events: auto;
        }
        
        /* Interactive Fish Styles */
        .interactive-fish {
            position: absolute;
            cursor: pointer;
            z-index: 25;
            pointer-events: auto;
            transition: transform 0.2s;
            filter: drop-shadow(2px 2px 5px rgba(0, 0, 0, 0.3));
        }
        
        .interactive-fish.caught {
            animation: caughtAnimation 0.8s forwards;
        }
        
        @keyframes caughtAnimation {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .fish-body {
            width: 60px;
            height: 30px;
            border-radius: 50%;
            position: relative;
        }
        
        .fish-tail {
            position: absolute;
            width: 20px;
            height: 30px;
            top: 0;
        }
        
        .fish-tail.right {
            right: -15px;
            border-top-right-radius: 100%;
            border-bottom-right-radius: 100%;
        }
        
        .fish-tail.left {
            left: -15px;
            border-top-left-radius: 100%;
            border-bottom-left-radius: 100%;
            transform: rotate(180deg);
        }
        
        .fish-eye {
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            top: 8px;
        }
        
        .fish-eye.right {
            right: 10px;
        }
        
        .fish-eye.left {
            left: 10px;
        }
        
        .fish-eye::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 4px;
            background: black;
            border-radius: 50%;
            top: 2px;
            left: 2px;
        }
        
        /* Catch Effect */
        .catch-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 150;
            display: none;
        }
        
        .catch-effect.active {
            display: block;
            animation: catchFlash 0.5s ease-out forwards;
        }
        
        @keyframes catchFlash {
            0% { background: rgba(79, 195, 247, 0.2); }
            100% { background: rgba(79, 195, 247, 0); }
        }
        
        /* Combo Display */
        .combo-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 72px;
            font-weight: 900;
            color: #4fc3f7;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
            pointer-events: none;
            z-index: 30;
            animation: comboAnim 1s ease-out forwards;
        }
        
        @keyframes comboAnim {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            40% { opacity: 1; transform: translate(-50%, -50%) scale(1.4); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1) translateY(-80px); }
        }
        
        /* Points Display */
        .points-display {
            position: absolute;
            font-size: 32px;
            font-weight: 900;
            color: #4fc3f7;
            text-shadow: 0 0 10px rgba(79, 195, 247, 0.8);
            pointer-events: none;
            z-index: 100;
            animation: pointsFloat 1s ease-out forwards;
        }
        
        @keyframes pointsFloat {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) translateY(-80px) scale(0.8);
            }
        }
        
        /* Bubble Effect */
        .bubble-effect {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            pointer-events: none;
            z-index: 10;
            animation: bubblePop 0.6s ease-out forwards;
        }
        
        @keyframes bubblePop {
            0% {
                width: 10px;
                height: 10px;
                opacity: 1;
                transform: scale(1);
            }
            100% {
                width: 100px;
                height: 100px;
                opacity: 0;
                transform: scale(2);
            }
        }
        
        /* Treasure */
        .treasure {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 60px;
            background: linear-gradient(to top, #ffd700, #ffab00);
            border-radius: 10px 10px 0 0;
            z-index: 5;
            pointer-events: none;
            box-shadow: 0 -5px 15px rgba(255, 215, 0, 0.3);
        }
        
        .treasure::before {
            content: "üí∞";
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 30px;
            filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
        }
    </style>
</head>
<body>
    <!-- Canvas Background -->
    <canvas id="canvas"></canvas>
    
    <!-- Game Area for Interactive Fish -->
    <div class="game-area" id="gameArea"></div>
    
    <!-- Treasure -->
    <div class="treasure"></div>
    
    <!-- Start Screen -->
    <div class="start-screen" id="startScreen">
        <h1 class="start-title">üê† Fish Catcher üê†</h1>
        <p class="start-subtitle">Catch as many colorful fish as you can in 60 seconds! Tap or click on fish to catch them. Each fish color is worth different points.</p>
        <button class="start-btn" id="startBtn">
            <i class="fas fa-play"></i> START GAME
        </button>
        <div class="instructions">
            <p>Underwater Adventure | Multi-touch Supported</p>
        </div>
    </div>
    
    <!-- Game UI -->
    <div class="game-ui">
        <div class="ui-top">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="scoreDisplay">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Time</div>
                    <div class="stat-value timer" id="timerDisplay">60</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Lives</div>
                    <div class="lives" id="livesDisplay">
                        <span class="heart">‚ù§Ô∏è</span>
                        <span class="heart">‚ù§Ô∏è</span>
                        <span class="heart">‚ù§Ô∏è</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Catch Effect -->
    <div class="catch-effect" id="catchEffect"></div>
    
    <!-- Game Over Screen -->
    <div class="game-over" id="gameOver">
        <h1>GAME OVER!</h1>
        <div class="final-score">Score: <span id="finalScore">0</span></div>
        <div class="high-score" id="highScore">High Score: 0</div>
        <div>
            <button class="go-btn" id="playAgainBtn">Play Again</button>
            <button class="go-btn" id="menuBtn">Main Menu</button>
        </div>
    </div>

    <script>
        // Background Canvas Animation (Provided Code)
        (function () {
            'use strict';
            window.addEventListener('load', function() {
                var canvas = document.getElementById('canvas');

                if (!canvas || !canvas.getContext) {
                    return false;
                }

                /********************
                  Random Number
                ********************/

                function rand(min, max) {
                    return Math.floor(Math.random() * (max - min + 1) + min);
                }

                /********************
                  Var
                ********************/

                // canvas 
                var ctx = canvas.getContext('2d');
                var X = canvas.width = window.innerWidth;
                var Y = canvas.height = window.innerHeight;
                var mouseX = null;
                var mouseY = null;

                /********************
                  Animation
                ********************/

                window.requestAnimationFrame =
                    window.requestAnimationFrame ||
                    window.mozRequestAnimationFrame ||
                    window.webkitRequestAnimationFrame ||
                    window.msRequestAnimationFrame ||
                    function(cb) {
                        setTimeout(cb, 17);
                    };

                /********************
                  Wave
                ********************/
                var waves = [];
                 
                function Wave(ctx, x, y, r) {
                    this.ctx = ctx;
                    this.init(x, y, r);
                }

                Wave.prototype.init = function(x, y, r) {
                    this.x = x;
                    this.y = y;
                    this.r = r;
                    this.l = rand(100, 150);
                };
                
                Wave.prototype.draw = function() {
                    ctx = this.ctx;
                    ctx.save();
                    ctx.beginPath();
                    ctx.strokeStyle = 'rgb(149, 188, 249)';
                    ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2, false);
                    ctx.stroke();
                    ctx.restore();
                };

                Wave.prototype.updateParams = function() {
                    this.r += 1;
                };

                Wave.prototype.deleteWave = function(i) {
                    if (this.r > this.l) {
                        waves.splice(i, 1);
                    }
                };

                Wave.prototype.render = function(i) {
                    this.updateParams();
                    this.deleteWave(i);
                    this.draw();
                };

                /********************
                  Fish
                ********************/

                var fishes = [];
                var fishDir = [true, false];
                var fishColors = ['255, 111, 147', '49, 194, 243', '255, 158, 0', '107, 136, 255'];

                function Fish(ctx, x, y, r, d, c) {
                    this.ctx = ctx;
                    this.init(x, y, r, d, c);
                }

                Fish.prototype.init = function(x, y, r, d, c) {
                    this.d = d;
                    this.x = x;
                    this.y = y;
                    this.r = r;
                    this.c = c;
                    this.rad = this.a * Math.PI / 180;
                    if (this.d === true) {
                        this.v = {
                            x: rand(1, 2) * 0.5,
                            y: rand(-1, 1) * 0.5
                        };
                    } else {
                        this.v = {
                            x: rand(-2, -1) * 0.5,
                            y: rand(-1, 1) * 0.5
                        };
                    }
                };
                
                Fish.prototype.draw = function() {
                    ctx = this.ctx;
                    ctx.save();
                    ctx.beginPath();
                    ctx.fillStyle = 'rgb(' + this.c + ')';
                    ctx.scale(2, 1);
                    ctx.arc(this.x / 2, this.y, this.r, 0, Math.PI * 2, false);
                    ctx.fill();
                    ctx.beginPath();
                    if (this.d === true) {
                        ctx.moveTo(this.x / 2 + this.r / 2, this.y);
                        ctx.lineTo(this.x / 2 + this.r + this.r / 2, this.y + this.r / 2);
                        ctx.lineTo(this.x / 2 + this.r + this.r / 2, this.y - this.r / 2);
                    } else {
                        ctx.moveTo(this.x / 2 - this.r / 2, this.y);
                        ctx.lineTo(this.x / 2 - this.r - this.r / 2, this.y + this.r / 2);
                        ctx.lineTo(this.x / 2 - this.r - this.r / 2, this.y - this.r / 2);
                    }
                    ctx.fill();
                    ctx.restore();
                };

                Fish.prototype.updatePosition = function() {
                    this.x -= this.v.x;
                    this.y += this.v.y;
                };

                Fish.prototype.wrapPosition = function() {
                    if (this.x + this.r + this.r > X) {
                        this.v.x *= -1;
                        this.d = true;
                    }
                    if (this.x - this.r - this.r < 0) {
                        this.v.x *= -1;
                        this.d = false;
                    }
                    if (this.y + this.r > Y) {
                        this.v.y *= -1;
                    }
                    if (this.y - this.r < 0) {
                        this.v.y *= -1;
                    }
                };

                Fish.prototype.resize = function() {
                    this.x = rand(0, X);
                    this.y = rand(0, Y);
                };

                Fish.prototype.render = function() {
                    this.updatePosition();
                    this.wrapPosition();
                    this.draw();
                };

                /********************
                  Grass
                ********************/
                
                // var
                var grassNum = 200;
                var grasses = [];

                function Grass(ctx, x, y, w, t) {
                    this.ctx = ctx;
                    this.init(x, y, w, t);
                }

                Grass.prototype.init = function(x, y, w, t) {
                    this.x = x;
                    this.y = y;
                    this.w = w;
                    this.t = t;
                    this.a = 0;
                    this.rad = this.a * Math.PI / 180;
                    this.c = '255, 255, 255';
                    this.v = {
                        x: Math.cos(this.rad),
                        y: Math.sin(this.rad)
                    };
                    this.xt = this.x + this.w;
                    this.yt = this.y - this.t;
                    this.xb = this.x + this.w + this.w;
                };
                
                Grass.prototype.updateParams = function() {
                    this.a += Math.random();
                    this.rad = this.a * Math.PI / 180;
                    this.v.x = Math.cos(this.rad) * 0.3;
                    this.v.y = Math.sin(this.rad) * 0.3;
                };

                Grass.prototype.updatePosition = function() {
                    this.xt += this.v.x;
                };
                
                Grass.prototype.draw = function() {
                    ctx = this.ctx;
                    ctx.save();
                    ctx.fillStyle = 'rgb(86, 116, 25)';
                    ctx.beginPath();
                    ctx.moveTo(this.x, this.y);
                    ctx.lineTo(this.xt, this.yt);
                    ctx.lineTo(this.xb, this.y);
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                };

                Grass.prototype.resize = function() {
                    for (var i = 0; i < grassNum; i++) {
                        grasses[i].init(rand(-10, X + 10), Y, rand(2.5, 5), rand(100, 200));
                    }
                };

                Grass.prototype.render = function() {
                    this.updateParams();
                    this.updatePosition();
                    this.draw();
                };

                for (var i = 0; i < grassNum; i++) {
                    var grass = new Grass(ctx, rand(-10, X + 10), Y, rand(2.5, 5), rand(100, 200));
                    grasses.push(grass);
                }
               
                /********************
                  Bubble
                ********************/
                
                // var
                var bubbleNum = 30;
                var bubbles = [];

                function Bubble(ctx, x, y, r) {
                    this.ctx = ctx;
                    this.init(x, y, r);
                }

                Bubble.prototype.init = function(x, y, r) {
                    this.x = x;
                    this.y = y;
                    this.r = r;
                    this.a = rand(1, 10);
                    this.dist = rand(1, 10);
                    this.rad = this.a * Math.PI / 180;
                    this.c = '255, 255, 255';
                    this.v = {
                        x: Math.sin(this.rad),
                        y: Math.cos(this.rad)
                    };
                };
                
                Bubble.prototype.updateParams = function() {
                    this.a += 1;
                    this.rad = this.a * Math.PI / 180;
                    this.y -= 1;
                };

                Bubble.prototype.wrapPosition = function() {
                    if (this.x - this.r > X) {
                        this.x = 0;
                    }
                    if (this.x + this.r < 0) {
                        this.x = X;
                    }
                    if (this.y - this.r > Y) {
                        this.y = 0;
                    }
                    if (this.y + this.r < 0) {
                        this.y = Y;
                    }
                };
                
                Bubble.prototype.draw = function() {
                    ctx = this.ctx;
                    ctx.save();
                    ctx.beginPath();
                    ctx.globalAlpha = 0.3;
                    ctx.fillStyle = 'rgb(255, 255, 255)';
                    ctx.arc(Math.cos(this.rad) * this.dist + this.x, Math.sin(this.rad) * this.dist + this.y, this.r, Math.PI * 2, false);
                    ctx.fill();
                    ctx.closePath();
                    ctx.restore();
                };

                Bubble.prototype.resize = function() {
                    this.x = rand(0, X);
                    this.y = rand(0, Y);
                };

                Bubble.prototype.render = function() {
                    this.updateParams();
                    this.wrapPosition();
                    this.draw();
                };

                for (var i = 0; i < bubbleNum; i++) {
                    var bubble = new Bubble(ctx, rand(0, X), rand(0, Y), rand(1, 10));
                    bubbles.push(bubble);
                }

                /********************
                  Render
                ********************/
                
                function render(){
                    ctx.clearRect(0, 0, X, Y);
                    for (var i = 0; i < grasses.length; i++) {
                        grasses[i].render();
                    }
                    for (var i = 0; i < bubbles.length; i++) {
                        bubbles[i].render();
                    }
                    for (var i = 0; i < fishes.length; i++) {
                        fishes[i].render();
                    }
                    for (var i = 0; i < waves.length; i++) {
                        waves[i].render(i);
                    }
                    requestAnimationFrame(render);
                }

                render();

                /********************
                  Event
                ********************/
                
                // resize
                function onResize() {
                    X = canvas.width = window.innerWidth;
                    Y = canvas.height = window.innerHeight;
                    for (var i = 0; i < grasses.length; i++) {
                        grasses[i].resize();
                    }
                    for (var i = 0; i < bubbles.length; i++) {
                        bubbles[i].resize();
                    }
                }

                window.addEventListener('resize', function() {
                    onResize();
                });

                // Don't add fish on click for game, but keep for background effect
                canvas.addEventListener('click', function(e) {
                    mouseX = e.clientX;
                    mouseY = e.clientY;
                    var fish = new Fish(ctx, mouseX, mouseY, rand(5, 15), fishDir[rand(0, 1)], fishColors[rand(0, fishColors.length - 1)]);
                    fishes.push(fish);
                    var wave = new Wave(ctx, mouseX, mouseY, 0);
                    waves.push(wave);
                }, false);

            });
        })();

        // Game Logic
        let score = 0;
        let lives = 3;
        let timeLeft = 60;
        let gameRunning = false;
        let gameStarted = false;
        let interactiveFishes = [];
        let combo = 0;
        let comboTimer = 0;
        let highScore = localStorage.getItem('fishHighScore') || 0;
        let spawnTimer = null;
        let clockTimer = null;
        
        // Fish types and colors
        const fishTypes = [
            { color: '#ff6f93', name: 'Pink', points: 10 },
            { color: '#31c2f3', name: 'Blue', points: 15 },
            { color: '#ff9e00', name: 'Orange', points: 20 },
            { color: '#6b88ff', name: 'Purple', points: 12 },
            { color: '#4fc3f7', name: 'Light Blue', points: 18 },
            { color: '#ffd700', name: 'Gold', points: 25 }
        ];
        
        // DOM elements
        const gameArea = document.getElementById('gameArea');
        const startScreen = document.getElementById('startScreen');
        const startBtn = document.getElementById('startBtn');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const timerDisplay = document.getElementById('timerDisplay');
        const livesDisplay = document.getElementById('livesDisplay');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const highScoreElement = document.getElementById('highScore');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const menuBtn = document.getElementById('menuBtn');
        const catchEffect = document.getElementById('catchEffect');
        
        // Initialize high score display
        highScoreElement.textContent = `High Score: ${highScore}`;
        
        // Start game function
        function startGame() {
            gameStarted = true;
            gameRunning = true;
            
            // Hide start screen
            startScreen.style.display = 'none';
            
            // Reset game variables
            score = 0;
            lives = 3;
            timeLeft = 60;
            interactiveFishes = [];
            combo = 0;
            
            // Update UI
            updateScore();
            updateTimer();
            updateLives();
            
            // Start game timers
            spawnTimer = setInterval(spawnInteractiveFish, 1000);
            clockTimer = setInterval(updateGameClock, 1000);
            
            // Create initial fish
            for (let i = 0; i < 5; i++) {
                setTimeout(() => spawnInteractiveFish(), i * 400);
            }
        }
        
        // Spawn an interactive fish
        function spawnInteractiveFish() {
            if (!gameRunning) return;
            
            const fishContainer = document.createElement('div');
            fishContainer.className = 'interactive-fish';
            
            // Random position
            const side = Math.floor(Math.random() * 4); // 0: left, 1: top, 2: right, 3: bottom
            
            let x, y;
            switch(side) {
                case 0: // Left
                    x = -60;
                    y = Math.random() * (window.innerHeight - 100) + 50;
                    break;
                case 1: // Top
                    x = Math.random() * (window.innerWidth - 100) + 50;
                    y = -60;
                    break;
                case 2: // Right
                    x = window.innerWidth + 60;
                    y = Math.random() * (window.innerHeight - 100) + 50;
                    break;
                case 3: // Bottom
                    x = Math.random() * (window.innerWidth - 100) + 50;
                    y = window.innerHeight + 60;
                    break;
            }
            
            fishContainer.style.left = `${x}px`;
            fishContainer.style.top = `${y}px`;
            
            // Random size
            const size = Math.random() * 0.8 + 0.5;
            fishContainer.style.transform = `scale(${size})`;
            
            // Random fish type
            const fishType = fishTypes[Math.floor(Math.random() * fishTypes.length)];
            const direction = Math.random() > 0.5 ? 'right' : 'left';
            
            // Create fish HTML structure
            fishContainer.innerHTML = `
                <div class="fish-body" style="background-color: ${fishType.color};">
                    <div class="fish-tail ${direction}" style="background-color: ${fishType.color};"></div>
                    <div class="fish-eye ${direction === 'right' ? 'right' : 'left'}"></div>
                </div>
            `;
            
            // Add event listeners for catching
            fishContainer.addEventListener('click', catchFish);
            fishContainer.addEventListener('touchstart', catchFish, { passive: true });
            
            // Add to game area
            gameArea.appendChild(fishContainer);
            
            // Random movement
            const targetX = Math.random() * (window.innerWidth - 100) + 50;
            const targetY = Math.random() * (window.innerHeight - 100) + 50;
            const speed = Math.random() * 2 + 1;
            const wobbleSpeed = Math.random() * 0.02 + 0.01;
            const wobbleAmount = Math.random() * 30 + 20;
            
            interactiveFishes.push({
                element: fishContainer,
                x: x,
                y: y,
                targetX: targetX,
                targetY: targetY,
                speed: speed,
                type: fishType,
                direction: direction,
                wobblePhase: Math.random() * Math.PI * 2,
                wobbleSpeed: wobbleSpeed,
                wobbleAmount: wobbleAmount,
                time: 0
            });
            
            // Remove fish after some time if not caught
            setTimeout(() => {
                if (fishContainer.parentNode && gameRunning) {
                    fishContainer.remove();
                    interactiveFishes = interactiveFishes.filter(f => f.element !== fishContainer);
                    
                    // Lose a life if fish escapes
                    if (lives > 0) {
                        lives--;
                        updateLives();
                        
                        if (lives <= 0) {
                            endGame();
                        }
                    }
                }
            }, 15000);
        }
        
        // Catch fish
        function catchFish(event) {
            if (!gameRunning) return;
            
            event.preventDefault();
            event.stopPropagation();
            
            const fishElement = event.currentTarget;
            const fish = interactiveFishes.find(f => f.element === fishElement);
            
            if (!fish) return;
            
            // Get click position
            const rect = fishElement.getBoundingClientRect();
            const clickX = rect.left + rect.width / 2;
            const clickY = rect.top + rect.height / 2;
            
            // Add caught animation
            fishElement.classList.add('caught');
            
            // Update score with combo
            combo++;
            comboTimer = 60;
            const points = fish.type.points + (combo >= 3 ? combo * 3 : 0);
            score += points;
            
            // Play bubble sound
            playBubbleSound();
            
            // Create bubble effect
            const bubbleEffect = document.createElement('div');
            bubbleEffect.className = 'bubble-effect';
            bubbleEffect.style.left = `${clickX}px`;
            bubbleEffect.style.top = `${clickY}px`;
            bubbleEffect.style.backgroundColor = fish.type.color + '80'; // Add transparency
            document.body.appendChild(bubbleEffect);
            
            setTimeout(() => {
                bubbleEffect.remove();
            }, 600);
            
            // Show points display
            const pointsDisplay = document.createElement('div');
            pointsDisplay.className = 'points-display';
            pointsDisplay.textContent = `+${points}`;
            pointsDisplay.style.left = `${clickX}px`;
            pointsDisplay.style.top = `${clickY}px`;
            document.body.appendChild(pointsDisplay);
            
            setTimeout(() => {
                pointsDisplay.remove();
            }, 1000);
            
            // Show combo if applicable
            if (combo >= 3) {
                showCombo(combo);
            }
            
            // Update UI
            updateScore();
            
            // Show catch effect
            catchEffect.classList.add('active');
            setTimeout(() => {
                catchEffect.classList.remove('active');
            }, 500);
            
            // Remove from arrays
            interactiveFishes = interactiveFishes.filter(f => f.element !== fishElement);
            
            // Remove from DOM after animation
            setTimeout(() => {
                if (fishElement.parentNode) {
                    fishElement.remove();
                }
            }, 800);
        }
        
        // Play bubble sound effect
        function playBubbleSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.2);
                
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                console.log('Audio context not available');
            }
        }
        
        // Show combo display
        function showCombo(comboCount) {
            const comboDisplay = document.createElement('div');
            comboDisplay.className = 'combo-display';
            comboDisplay.textContent = `${comboCount}x COMBO!`;
            comboDisplay.style.left = `${Math.random() * 60 + 20}%`;
            document.body.appendChild(comboDisplay);
            
            setTimeout(() => {
                comboDisplay.remove();
            }, 1000);
        }
        
        // Update game clock
        function updateGameClock() {
            if (!gameRunning) {
                clearInterval(clockTimer);
                return;
            }
            
            timeLeft--;
            updateTimer();
            
            if (timeLeft <= 10) {
                timerDisplay.style.color = '#ff6b6b';
            }
            
            if (timeLeft <= 0) {
                endGame();
            }
            
            // Update combo timer
            if (comboTimer > 0) {
                comboTimer--;
                if (comboTimer === 0) {
                    combo = 0;
                }
            }
        }
        
        // Update score display
        function updateScore() {
            scoreDisplay.textContent = score;
        }
        
        // Update timer display
        function updateTimer() {
            timerDisplay.textContent = timeLeft;
        }
        
        // Update lives display
        function updateLives() {
            livesDisplay.innerHTML = '';
            for (let i = 0; i < 3; i++) {
                const heart = document.createElement('span');
                heart.className = 'heart';
                heart.textContent = i < lives ? '‚ù§Ô∏è' : 'ü§ç';
                livesDisplay.appendChild(heart);
            }
        }
        
        // End game
        function endGame() {
            gameRunning = false;
            
            // Clear timers
            if (spawnTimer) {
                clearInterval(spawnTimer);
                spawnTimer = null;
            }
            if (clockTimer) {
                clearInterval(clockTimer);
                clockTimer = null;
            }
            
            // Remove all interactive fish
            interactiveFishes.forEach(fish => {
                if (fish.element.parentNode) {
                    fish.element.remove();
                }
            });
            interactiveFishes = [];
            
            // Update final score
            finalScoreElement.textContent = score;
            
            // Update high score if needed
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('fishHighScore', highScore);
                highScoreElement.innerHTML = `<i class="fas fa-trophy"></i> New High Score: ${highScore}`;
                highScoreElement.style.color = '#ffd700';
            } else {
                highScoreElement.textContent = `High Score: ${highScore}`;
                highScoreElement.style.color = '#4fc3f7';
            }
            
            // Show game over screen
            gameOverScreen.classList.add('show');
        }
        
        // Restart game
        function restartGame() {
            gameOverScreen.classList.remove('show');
            startGame();
        }
        
        // Return to menu
        function returnToMenu() {
            gameOverScreen.classList.remove('show');
            startScreen.style.display = 'flex';
            
            // Reset game state
            gameRunning = false;
            gameStarted = false;
            
            // Clear timers
            if (spawnTimer) {
                clearInterval(spawnTimer);
                spawnTimer = null;
            }
            if (clockTimer) {
                clearInterval(clockTimer);
                clockTimer = null;
            }
            
            // Remove all interactive fish
            interactiveFishes.forEach(fish => {
                if (fish.element.parentNode) {
                    fish.element.remove();
                }
            });
            interactiveFishes = [];
            
            // Reset timer display
            timeLeft = 60;
            updateTimer();
            timerDisplay.style.color = '#ffd700';
        }
        
        // Fish movement animation
        function animateFish() {
            if (!gameRunning) {
                requestAnimationFrame(animateFish);
                return;
            }
            
            interactiveFishes.forEach(fish => {
                fish.time++;
                fish.wobblePhase += fish.wobbleSpeed;
                
                // Update wobble offset
                const wobbleX = Math.sin(fish.wobblePhase) * fish.wobbleAmount;
                const wobbleY = Math.cos(fish.wobblePhase * 1.5) * (fish.wobbleAmount * 0.5);
                
                // Move toward target with wobble
                const dx = fish.targetX - fish.x + wobbleX;
                const dy = fish.targetY - fish.y + wobbleY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 20) {
                    // Smooth movement with some randomness
                    const angle = Math.atan2(dy, dx);
                    const randomDeviation = (Math.random() - 0.5) * 0.2;
                    const actualAngle = angle + randomDeviation;
                    
                    fish.x += Math.cos(actualAngle) * fish.speed;
                    fish.y += Math.sin(actualAngle) * fish.speed;
                    
                    // Update fish position
                    fish.element.style.left = `${fish.x}px`;
                    fish.element.style.top = `${fish.y}px`;
                    
                    // Update direction based on movement
                    if (dx > 0 && fish.direction === 'left') {
                        fish.direction = 'right';
                        fish.element.querySelector('.fish-tail').className = 'fish-tail right';
                        fish.element.querySelector('.fish-eye').className = 'fish-eye right';
                    } else if (dx < 0 && fish.direction === 'right') {
                        fish.direction = 'left';
                        fish.element.querySelector('.fish-tail').className = 'fish-tail left';
                        fish.element.querySelector('.fish-eye').className = 'fish-eye left';
                    }
                } else {
                    // Set new random target
                    fish.targetX = Math.random() * (window.innerWidth - 100) + 50;
                    fish.targetY = Math.random() * (window.innerHeight - 100) + 50;
                }
            });
            
            requestAnimationFrame(animateFish);
        }
        
        // Event listeners
        startBtn.addEventListener('click', startGame);
        startBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            startGame();
        }, { passive: false });
        
        playAgainBtn.addEventListener('click', restartGame);
        playAgainBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            restartGame();
        }, { passive: false });
        
        menuBtn.addEventListener('click', returnToMenu);
        menuBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            returnToMenu();
        }, { passive: false });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // Reposition fish if they go out of bounds
            interactiveFishes.forEach(fish => {
                const rect = fish.element.getBoundingClientRect();
                if (rect.right < -100 || rect.bottom < -100 || 
                    rect.left > window.innerWidth + 100 || rect.top > window.innerHeight + 100) {
                    fish.x = Math.random() * (window.innerWidth - 100) + 50;
                    fish.y = Math.random() * (window.innerHeight - 100) + 50;
                    fish.element.style.left = `${fish.x}px`;
                    fish.element.style.top = `${fish.y}px`;
                }
            });
        });
        
        // Multi-touch support
        document.addEventListener('touchstart', function(e) {
            if (!gameRunning) return;
            
            // Prevent default to avoid scrolling
            if (e.target.closest('.interactive-fish')) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // Initialize animation loop
        animateFish();
    </script>
</body>
</html>