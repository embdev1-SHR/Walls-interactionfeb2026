<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Alphabet Explorer ¬∑ 57 Malayalam + English</title>
  <!-- Google Font for authentic Malayalam -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0a1a0a 0%, #0d2818 50%, #0a1a0a 100%);
      color: white;
      -webkit-user-select: none;
      user-select: none;
    }

    .ml {
      font-family: 'Noto Sans Malayalam', -apple-system, sans-serif;
    }

    .app {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 1;
    }

    /* ----- HEADER ----- */
    .header {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
    }

    .header h1 {
      font-size: clamp(18px, 2.5vw, 28px);
      font-weight: 800;
      color: #4ade80;
      text-shadow: 0 0 8px rgba(74,222,128,0.3);
    }

    .header-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .btn-back {
      padding: 8px 22px;
      font-size: 13px;
      font-weight: 600;
      background: rgba(74, 222, 128, 0.1);
      border: 2px solid rgba(74, 222, 128, 0.3);
      color: white;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-back:hover {
      background: rgba(74, 222, 128, 0.2);
    }

    /* ----- LANGUAGE TOGGLE ----- */
    .lang-toggle {
      display: flex;
      border-radius: 50px;
      overflow: hidden;
      border: 2px solid rgba(74, 222, 128, 0.3);
    }

    .lang-btn {
      padding: 6px 14px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      background: transparent;
      color: rgba(255, 255, 255, 0.5);
      border: none;
    }

    .lang-btn.active {
      background: rgba(74, 222, 128, 0.2);
      color: #4ade80;
    }

    /* ----- CENTER DISPLAY (BIG LETTER + WORD) ----- */
    .center-display {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: clamp(4px, 1vh, 12px);
      padding: 0 20px;
      min-height: 0;
    }

    .big-letter {
      font-size: clamp(130px, 24vw, 240px);
      font-weight: 900;
      line-height: 1;
      color: #4ade80;
      text-shadow: 0 0 60px rgba(74, 222, 128, 0.3);
      transition: all 0.4s;
      animation: letterIn 0.4s ease;
    }

    .big-letter.ml {
      font-size: clamp(90px, 18vw, 180px);
    }

    @keyframes letterIn {
      0% { transform: scale(0.5) rotateY(90deg); opacity: 0; }
      100% { transform: scale(1) rotateY(0); opacity: 1; }
    }

    .letter-pair {
      font-size: clamp(28px, 4vw, 48px);
      font-weight: 700;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 8px;
    }

    .example-word {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: clamp(18px, 2.5vw, 30px);
      font-weight: 700;
      color: rgba(255, 255, 255, 0.6);
    }

    .example-emoji {
      font-size: clamp(36px, 5vw, 56px);
    }

    .example-text span {
      color: #fbbf24;
      font-weight: 800;
    }

    .phonetic {
      font-size: clamp(13px, 1.3vw, 17px);
      color: rgba(255, 255, 255, 0.3);
      font-style: italic;
    }

    /* ----- BOTTOM LETTER LIST (CENTER ALIGNED, TOP RAISED) ----- */
    .letter-list {
      flex-shrink: 0;
      padding: 12px 16px 16px;
      background: rgba(0, 0, 0, 0.25);
      border-top: 2px solid rgba(74, 222, 128, 0.2);
      backdrop-filter: blur(4px);
    }

    .list-label {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.5);
      text-align: center;
      margin-bottom: 8px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    /* ----- GRID: CENTER ALIGNED, WRAPPING, TOP PADDING MINIMAL ----- */
    .list-scroll {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;      /* ‚òÖ‚òÖ‚òÖ CENTER ALIGNMENT ‚òÖ‚òÖ‚òÖ */
      align-items: center;
      gap: 8px;
      padding: 8px 4px 4px 4px;
      max-height: 160px;
      overflow-y: auto;
      overflow-x: hidden;
      scrollbar-width: thin;
      scrollbar-color: #4ade8040 #0a1a0a;
    }

    .list-scroll::-webkit-scrollbar {
      width: 5px;
    }
    .list-scroll::-webkit-scrollbar-track {
      background: #0a1a0a;
    }
    .list-scroll::-webkit-scrollbar-thumb {
      background: #4ade8040;
      border-radius: 8px;
    }

    /* ----- LETTER BUTTONS (PERFECT GRID) ----- */
    .letter-btn {
      flex-shrink: 0;
      width: clamp(44px, 5vw, 56px);
      height: clamp(44px, 5vw, 56px);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(16px, 1.9vw, 22px);
      font-weight: 700;
      background: rgba(74, 222, 128, 0.08);
      border: 2px solid rgba(74, 222, 128, 0.15);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: rgba(255, 255, 255, 0.8);
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .letter-btn.ml {
      font-size: clamp(14px, 1.6vw, 18px);
      font-family: 'Noto Sans Malayalam', sans-serif;
    }

    .letter-btn:hover {
      background: rgba(74, 222, 128, 0.2);
      border-color: rgba(74, 222, 128, 0.6);
      transform: scale(1.08);
    }

    .letter-btn.active {
      background: rgba(74, 222, 128, 0.3);
      border-color: #4ade80;
      color: #ffffff;
      box-shadow: 0 0 18px #4ade80;
      transform: scale(1.12);
    }

    .nav-arrows {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 12px;
    }

    .arrow-btn {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      font-weight: 800;
      background: rgba(74, 222, 128, 0.1);
      border: 2px solid rgba(74, 222, 128, 0.2);
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s;
      color: rgba(255, 255, 255, 0.7);
    }

    .arrow-btn:hover {
      background: rgba(74, 222, 128, 0.25);
      color: white;
      transform: scale(1.1);
    }

    /* ----- BACKGROUND DECOR ----- */
    .bg-particles {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .bg-dot {
      position: absolute;
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: rgba(74, 222, 128, 0.2);
      animation: float var(--dur) ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); opacity: 0.15; }
      50% { transform: translate(var(--dx), var(--dy)); opacity: 0.5; }
    }

    .touch-ring {
      position: fixed;
      width: 60px;
      height: 60px;
      border: 3px solid rgba(74, 222, 128, 0.6);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      transform: translate(-50%, -50%) scale(0);
      animation: ringPop 0.6s ease forwards;
    }

    @keyframes ringPop {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
    }

    @media (max-width: 480px) {
      .letter-btn {
        width: 40px;
        height: 40px;
        font-size: 15px;
      }
      .letter-btn.ml {
        font-size: 13px;
      }
      .big-letter.ml {
        font-size: 120px;
      }
    }
  </style>
</head>
<body>
  <audio id="alphabet-explorer-music" preload="auto" loop>
    <source src="../assets/Audio/idoberg-space-chords-loop-310493.mp3" type="audio/mpeg">
  </audio>

  <div class="bg-particles" id="bgP"></div>

  <div class="app">
    <div class="header">
      <h1>Alphabet Explorer</h1>
      <div class="header-right">
        <button class="btn-back" id="btnBack">‚Üê Back</button>
      </div>
    </div>

    <!-- CENTER BIG LETTER & EXAMPLE -->
    <div class="center-display">
      <div class="big-letter" id="bigLetter">A</div>
      <div class="letter-pair" id="letterPair">A a</div>
      <div class="example-word" id="exampleWord"></div>
      <div class="phonetic" id="phonetic"></div>
    </div>

    <!-- BOTTOM: ALPHABET GRID ‚Äì CENTER ALIGNED, TOP RAISED, 57 MALAYALAM + 26 ENGLISH -->
    <div class="letter-list">
      <div style="display:flex; justify-content:center; margin-bottom:8px;">
        <div class="lang-toggle">
          <div class="lang-btn active" data-lang="en">English</div>
          <div class="lang-btn" data-lang="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</div>
        </div>
      </div>
      <div class="list-label" id="listLabel">‚ú¶  TAP TO EXPLORE  ‚ú¶</div>
      
      <!-- ‚òÖ‚òÖ‚òÖ CENTER-ALIGNED WRAPPING GRID ‚òÖ‚òÖ‚òÖ -->
      <div class="list-scroll" id="letterList"></div>
      
      <div class="nav-arrows">
        <div class="arrow-btn" id="prevBtn">‚Üê</div>
        <div class="arrow-btn" id="nextBtn">‚Üí</div>
      </div>
    </div>
  </div>

  <script>
    // ------------------------------------------------------------
    //   COMPLETE DATASET: 26 ENGLISH + 57 MALAYALAM LETTERS
    //   FULLY CENTER-ALIGNED & TOP-RAISED BOTTOM GRID
    // ------------------------------------------------------------

    // ----- 57 AUTHENTIC MALAYALAM LETTERS (MODERN FULL SET) -----
    const ML_FULL_SET = [
      // Vowels & signs
      '‡¥Ö', '‡¥Ü', '‡¥á', '‡¥à', '‡¥â', '‡¥ä', '‡¥ã', 
      '‡¥é', '‡¥è', '‡¥ê', '‡¥í', '‡¥ì', '‡¥î', '‡¥Ç', '‡¥É', 
      // Consonants
      '‡¥ï', '‡¥ñ', '‡¥ó', '‡¥ò', '‡¥ô',
      '‡¥ö', '‡¥õ', '‡¥ú', '‡¥ù', '‡¥û',
      '‡¥ü', '‡¥†', '‡¥°', '‡¥¢', '‡¥£',
      '‡¥§', '‡¥•', '‡¥¶', '‡¥ß', '‡¥®',
      '‡¥™', '‡¥´', '‡¥¨', '‡¥≠', '‡¥Æ',
      '‡¥Ø', '‡¥∞', '‡¥≤', '‡¥µ', '‡¥∂',
      '‡¥∑', '‡¥∏', '‡¥π', '‡¥≥', '‡¥¥', '‡¥±',
      '‡µ∫', '‡µª', '‡µº', '‡µΩ', '‡µæ', '‡µø'
    ]; // exactly 57 letters

    // ----- ENRICHED MALAYALAM DATA (with words, meanings, emoji) -----
    const ML_DATA = [
      { letter: '‡¥Ö', word: '‡¥Ö‡¥Æ‡µç‡¥Æ', meaning: 'Mother', emoji: 'üë©', phonetic: 'a' },
      { letter: '‡¥Ü', word: '‡¥Ü‡¥®', meaning: 'Elephant', emoji: 'üêò', phonetic: 'aa' },
      { letter: '‡¥á', word: '‡¥á‡¥≤', meaning: 'Leaf', emoji: 'üåø', phonetic: 'i' },
      { letter: '‡¥à', word: '‡¥à‡¥ö‡µç‡¥ö', meaning: 'Fly', emoji: 'ü™∞', phonetic: 'ee' },
      { letter: '‡¥â', word: '‡¥â‡¥±‡µÅ‡¥Æ‡µç‡¥™‡µç', meaning: 'Ant', emoji: 'üêú', phonetic: 'u' },
      { letter: '‡¥ä', word: '‡¥ä‡¥û‡µç‡¥û‡¥æ‡µΩ', meaning: 'Swing', emoji: 'üé¢', phonetic: 'oo' },
      { letter: '‡¥ã', word: '‡¥ã‡¥∑‡¥ø', meaning: 'Sage', emoji: 'üßò', phonetic: 'ru' },
      { letter: '‡¥é', word: '‡¥é‡¥≤‡¥ø', meaning: 'Rat', emoji: 'üêÄ', phonetic: 'e' },
      { letter: '‡¥è', word: '‡¥è‡¥£‡¥ø', meaning: 'Ladder', emoji: 'ü™ú', phonetic: 'ae' },
      { letter: '‡¥ê', word: '‡¥ê‡¥∏‡µç‡¥ï‡µç‡¥∞‡µÄ‡¥Ç', meaning: 'Ice cream', emoji: 'üç¶', phonetic: 'ai' },
      { letter: '‡¥í', word: '‡¥í‡¥ü‡µç‡¥ü‡¥ï‡¥Ç', meaning: 'Camel', emoji: 'üê´', phonetic: 'o' },
      { letter: '‡¥ì', word: '‡¥ì‡¥ü', meaning: 'Flute', emoji: 'üé∂', phonetic: 'oa' },
      { letter: '‡¥î', word: '‡¥î‡¥∑‡¥ß‡¥Ç', meaning: 'Medicine', emoji: 'üíä', phonetic: 'au' },
      { letter: '‡¥Ç', word: '‡¥Ö‡¥Ç‡¥¨‡¥∞‡¥Ç', meaning: 'Sky', emoji: 'üåå', phonetic: 'am' },
      { letter: '‡¥É', word: '‡¥Ö‡¥É', meaning: 'ah', emoji: 'üå¨Ô∏è', phonetic: 'ah' },
      { letter: '‡¥ï', word: '‡¥ï‡¥æ‡¥ï‡µç‡¥ï', meaning: 'Crow', emoji: 'üê¶‚Äç‚¨õ', phonetic: 'ka' },
      { letter: '‡¥ñ', word: '‡¥ñ‡¥°‡µç‡¥ó‡¥Ç', meaning: 'Sword', emoji: '‚öîÔ∏è', phonetic: 'kha' },
      { letter: '‡¥ó', word: '‡¥ó‡¥ú‡¥Ç', meaning: 'Elephant', emoji: 'üêò', phonetic: 'ga' },
      { letter: '‡¥ò', word: '‡¥ò‡¥ü‡¥ø‡¥ï‡¥æ‡¥∞‡¥Ç', meaning: 'Clock', emoji: '‚è∞', phonetic: 'gha' },
      { letter: '‡¥ô', word: '‡¥ô‡¥æ‡¥™‡µç‡¥™', meaning: 'Gape', emoji: 'üòÆ', phonetic: 'nga' },
      { letter: '‡¥ö', word: '‡¥ö‡¥®‡µç‡¥¶‡µç‡¥∞‡µª', meaning: 'Moon', emoji: 'üåï', phonetic: 'cha' },
      { letter: '‡¥õ', word: '‡¥õ‡¥§‡µç‡¥∞‡¥ø', meaning: 'Umbrella', emoji: '‚òÇÔ∏è', phonetic: 'chha' },
      { letter: '‡¥ú', word: '‡¥ú‡¥≤‡¥Ç', meaning: 'Water', emoji: 'üíß', phonetic: 'ja' },
      { letter: '‡¥ù', word: '‡¥ù‡¥∞‡¥ø', meaning: 'Waterfall', emoji: 'üåä', phonetic: 'jha' },
      { letter: '‡¥û', word: '‡¥û‡¥æ‡µª', meaning: 'I', emoji: 'üßë', phonetic: 'nya' },
      { letter: '‡¥ü', word: '‡¥ü‡¥Æ‡¥æ‡¥ü‡µã', meaning: 'Tomato', emoji: 'üçÖ', phonetic: 'ta' },
      { letter: '‡¥†', word: '‡¥†‡¥æ‡¥ï‡µç‡¥ï', meaning: 'Bag', emoji: 'üëú', phonetic: 'tha' },
      { letter: '‡¥°', word: '‡¥°‡µã‡¥ï‡µç‡¥ü‡µº', meaning: 'Doctor', emoji: 'üë®‚Äç‚öïÔ∏è', phonetic: 'da' },
      { letter: '‡¥¢', word: '‡¥¢‡¥ï‡µç‡¥ï', meaning: 'Drum', emoji: 'ü•Å', phonetic: 'dha' },
      { letter: '‡¥£', word: '‡¥£‡¥§‡µç‡¥§‡¥æ‡µº', meaning: 'Peacock', emoji: 'ü¶ö', phonetic: 'na' },
      { letter: '‡¥§', word: '‡¥§‡¥§‡µç‡¥§', meaning: 'Parrot', emoji: 'ü¶ú', phonetic: 'tha' },
      { letter: '‡¥•', word: '‡¥•‡¥æ‡µº', meaning: 'Desert', emoji: 'üèúÔ∏è', phonetic: 'thha' },
      { letter: '‡¥¶', word: '‡¥¶‡µÄ‡¥™‡¥Ç', meaning: 'Lamp', emoji: 'ü™î', phonetic: 'da' },
      { letter: '‡¥ß', word: '‡¥ß‡¥®‡¥Ç', meaning: 'Wealth', emoji: 'üí∞', phonetic: 'dha' },
      { letter: '‡¥®', word: '‡¥®‡¥æ‡¥Ø', meaning: 'Dog', emoji: 'üê∂', phonetic: 'na' },
      { letter: '‡¥™', word: '‡¥™‡µÇ‡¥µ‡µç', meaning: 'Flower', emoji: 'üå∏', phonetic: 'pa' },
      { letter: '‡¥´', word: '‡¥´‡¥≤‡¥Ç', meaning: 'Fruit', emoji: 'üçé', phonetic: 'pha' },
      { letter: '‡¥¨', word: '‡¥¨‡¥æ‡¥≤‡µª', meaning: 'Boy', emoji: 'üßí', phonetic: 'ba' },
      { letter: '‡¥≠', word: '‡¥≠‡µç‡¥∞‡¥Æ‡¥∞‡¥Ç', meaning: 'Bee', emoji: 'üêù', phonetic: 'bha' },
      { letter: '‡¥Æ', word: '‡¥Æ‡¥∞‡¥Ç', meaning: 'Tree', emoji: 'üå≥', phonetic: 'ma' },
      { letter: '‡¥Ø', word: '‡¥Ø‡¥Æ‡µÅ‡¥®', meaning: 'River', emoji: 'üèûÔ∏è', phonetic: 'ya' },
      { letter: '‡¥∞', word: '‡¥∞‡¥æ‡¥ú‡¥æ‡¥µ‡µç', meaning: 'King', emoji: 'üëë', phonetic: 'ra' },
      { letter: '‡¥≤', word: '‡¥≤‡¥°‡µç‡¥°‡µÅ', meaning: 'Laddu', emoji: 'üç¨', phonetic: 'la' },
      { letter: '‡¥µ', word: '‡¥µ‡µÄ‡¥ü‡µç', meaning: 'House', emoji: 'üè†', phonetic: 'va' },
      { letter: '‡¥∂', word: '‡¥∂‡¥≤‡¥≠‡¥Ç', meaning: 'Butterfly', emoji: 'ü¶ã', phonetic: 'sha' },
      { letter: '‡¥∑', word: '‡¥∑‡¥°‡µç‡¥™‡¥¶‡¥Ç', meaning: 'Insect', emoji: 'üêû', phonetic: 'sha' },
      { letter: '‡¥∏', word: '‡¥∏‡µÇ‡¥∞‡µç‡¥Ø‡µª', meaning: 'Sun', emoji: '‚òÄÔ∏è', phonetic: 'sa' },
      { letter: '‡¥π', word: '‡¥π‡¥Ç‡¥∏‡¥Ç', meaning: 'Swan', emoji: 'ü¶¢', phonetic: 'ha' },
      { letter: '‡¥≥', word: '‡¥≥‡¥æ‡¥ü‡µç‡¥ü', meaning: 'Rattle', emoji: 'ü™á', phonetic: 'la' },
      { letter: '‡¥¥', word: '‡¥Æ‡¥¥', meaning: 'Rain', emoji: '‚òî', phonetic: 'zha' },
      { letter: '‡¥±', word: '‡¥±‡¥¨‡µç‡¥¨‡µº', meaning: 'Rubber', emoji: 'üß§', phonetic: 'ra' },
      { letter: '‡µ∫', word: '‡¥ï‡µ∫', meaning: 'Eye', emoji: 'üëÅÔ∏è', phonetic: 'n' },
      { letter: '‡µª', word: '‡¥Æ‡µª', meaning: 'Man', emoji: 'üë®', phonetic: 'n' },
      { letter: '‡µº', word: '‡¥Ö‡µº', meaning: 'Half', emoji: '¬Ω', phonetic: 'r' },
      { letter: '‡µΩ', word: '‡¥Ö‡µΩ', meaning: 'Half', emoji: '‚Öì', phonetic: 'l' },
      { letter: '‡µæ', word: '‡¥Ö‡µæ', meaning: 'Half', emoji: '‚Öî', phonetic: 'll' },
      { letter: '‡µø', word: '‡¥ï‡µø', meaning: 'Final k', emoji: 'üîö', phonetic: 'k' }
    ];

    // ----- 26 ENGLISH LETTERS -----
    const EN_DATA = [
      { upper: 'A', lower: 'a', word: 'Apple', emoji: 'üçé', phonetic: '/ay/' },
      { upper: 'B', lower: 'b', word: 'Butterfly', emoji: 'ü¶ã', phonetic: '/bee/' },
      { upper: 'C', lower: 'c', word: 'Cat', emoji: 'üê±', phonetic: '/see/' },
      { upper: 'D', lower: 'd', word: 'Dog', emoji: 'üê∂', phonetic: '/dee/' },
      { upper: 'E', lower: 'e', word: 'Elephant', emoji: 'üêò', phonetic: '/ee/' },
      { upper: 'F', lower: 'f', word: 'Fish', emoji: 'üêü', phonetic: '/eff/' },
      { upper: 'G', lower: 'g', word: 'Grapes', emoji: 'üçá', phonetic: '/jee/' },
      { upper: 'H', lower: 'h', word: 'Horse', emoji: 'üê¥', phonetic: '/aitch/' },
      { upper: 'I', lower: 'i', word: 'Ice cream', emoji: 'üç¶', phonetic: '/eye/' },
      { upper: 'J', lower: 'j', word: 'Jellyfish', emoji: 'ü™º', phonetic: '/jay/' },
      { upper: 'K', lower: 'k', word: 'Kite', emoji: 'ü™Å', phonetic: '/kay/' },
      { upper: 'L', lower: 'l', word: 'Lion', emoji: 'ü¶Å', phonetic: '/ell/' },
      { upper: 'M', lower: 'm', word: 'Moon', emoji: 'üåô', phonetic: '/em/' },
      { upper: 'N', lower: 'n', word: 'Nest', emoji: 'ü™π', phonetic: '/en/' },
      { upper: 'O', lower: 'o', word: 'Orange', emoji: 'üçä', phonetic: '/oh/' },
      { upper: 'P', lower: 'p', word: 'Penguin', emoji: 'üêß', phonetic: '/pee/' },
      { upper: 'Q', lower: 'q', word: 'Queen', emoji: 'üë∏', phonetic: '/kew/' },
      { upper: 'R', lower: 'r', word: 'Rainbow', emoji: 'üåà', phonetic: '/ar/' },
      { upper: 'S', lower: 's', word: 'Star', emoji: '‚≠ê', phonetic: '/ess/' },
      { upper: 'T', lower: 't', word: 'Tree', emoji: 'üå≥', phonetic: '/tee/' },
      { upper: 'U', lower: 'u', word: 'Umbrella', emoji: '‚òî', phonetic: '/yoo/' },
      { upper: 'V', lower: 'v', word: 'Violin', emoji: 'üéª', phonetic: '/vee/' },
      { upper: 'W', lower: 'w', word: 'Whale', emoji: 'üêã', phonetic: '/dub-yoo/' },
      { upper: 'X', lower: 'x', word: 'Xylophone', emoji: 'üé∑', phonetic: '/ex/' },
      { upper: 'Y', lower: 'y', word: 'Yacht', emoji: '‚õµ', phonetic: '/why/' },
      { upper: 'Z', lower: 'z', word: 'Zebra', emoji: 'ü¶ì', phonetic: '/zed/' }
    ];

    // ----- STATE -----
    let lang = 'en';
    let currentIdx = 0;

    function getData() {
      return lang === 'en' ? EN_DATA : ML_DATA;
    }

    // ----- RENDER BIG DISPLAY -----
    function showLetter(idx) {
      const data = getData();
      if (idx < 0 || idx >= data.length) return;
      currentIdx = idx;
      const item = data[idx];

      const bigEl = document.getElementById('bigLetter');
      bigEl.style.animation = 'none';
      void bigEl.offsetWidth;
      bigEl.style.animation = 'letterIn .4s ease';

      if (lang === 'en') {
        bigEl.textContent = item.upper;
        bigEl.className = 'big-letter';
        document.getElementById('letterPair').textContent = `${item.upper} ${item.lower}`;
        document.getElementById('exampleWord').innerHTML =
          `<span class="example-emoji">${item.emoji}</span>
           <span class="example-text"><span>${item.upper}</span>${item.word.slice(1)}</span>`;
        document.getElementById('phonetic').textContent = item.phonetic;
      } else {
        bigEl.textContent = item.letter;
        bigEl.className = 'big-letter ml';
        document.getElementById('letterPair').textContent = item.phonetic;
        document.getElementById('exampleWord').innerHTML =
          `<span class="example-emoji">${item.emoji}</span>
           <span class="example-text ml">${item.word}</span>`;
        document.getElementById('phonetic').textContent = item.meaning;
      }

      // update active class on grid buttons
      document.querySelectorAll('.letter-btn').forEach((btn) => {
        btn.classList.toggle('active', parseInt(btn.dataset.idx) === idx);
      });

      // gentle sound feedback
      playTone(300 + idx * 15, 0.1);
    }

    // ----- BUILD GRID (CENTER-ALIGNED, TOP-RAISED) -----
    function buildList() {
      const container = document.getElementById('letterList');
      container.innerHTML = '';
      
      let displayArray;
      if (lang === 'en') {
        displayArray = EN_DATA.map((item, i) => ({ label: item.upper, idx: i }));
      } else {
        // use the FULL 57 Malayalam letters for grid
        displayArray = ML_FULL_SET.map((letter, i) => ({ label: letter, idx: i }));
      }

      displayArray.forEach((item) => {
        const btn = document.createElement('div');
        btn.className = `letter-btn ${lang === 'ml' ? 'ml' : ''} ${item.idx === currentIdx ? 'active' : ''}`;
        btn.dataset.idx = item.idx;
        btn.textContent = item.label;
        container.appendChild(btn);
      });
    }

    // ----- SWITCH LANGUAGE (preserve 57 ML letters) -----
    function switchLang(newLang) {
      lang = newLang;
      currentIdx = 0;
      document.querySelectorAll('.lang-btn').forEach(b => {
        b.classList.toggle('active', b.dataset.lang === lang);
      });
      buildList();
      showLetter(0);
    }

    // ----- SIMPLE TONE (interactive feedback) -----
    function playTone(freq, dur) {
      try {
        const ac = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ac.createOscillator();
        const gain = ac.createGain();
        osc.connect(gain);
        gain.connect(ac.destination);
        osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.1, ac.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, ac.currentTime + dur);
        osc.start();
        osc.stop(ac.currentTime + dur);
      } catch(e) {}
    }

    // ----- EVENT BINDING (touch + click) -----
    function bindTouch(el, fn) {
      el.addEventListener('click', (e) => { if (e.sourceCapabilities?.firesTouchEvents) return; fn(); });
      el.addEventListener('touchend', (e) => { e.preventDefault(); fn(); });
    }

    // ----- INIT & EVENT LISTENERS -----
    window.addEventListener('DOMContentLoaded', () => {
      buildList();
      showLetter(0);

      // Language toggle
      document.querySelectorAll('.lang-btn').forEach(btn => {
        bindTouch(btn, () => switchLang(btn.dataset.lang));
      });

      // Letter grid click
      document.getElementById('letterList').addEventListener('click', (e) => {
        if (e.sourceCapabilities?.firesTouchEvents) return;
        const btn = e.target.closest('.letter-btn');
        if (btn) showLetter(parseInt(btn.dataset.idx));
      });
      document.getElementById('letterList').addEventListener('touchend', (e) => {
        const btn = e.target.closest('.letter-btn');
        if (btn) { e.preventDefault(); showLetter(parseInt(btn.dataset.idx)); }
      });

      // Navigation arrows
      bindTouch(document.getElementById('prevBtn'), () => {
        const data = getData();
        const n = currentIdx > 0 ? currentIdx - 1 : data.length - 1;
        showLetter(n);
      });
      bindTouch(document.getElementById('nextBtn'), () => {
        const data = getData();
        const n = currentIdx < data.length - 1 ? currentIdx + 1 : 0;
        showLetter(n);
      });

      // Back button
      bindTouch(document.getElementById('btnBack'), () => {
        document.getElementById('alphabet-explorer-music')?.pause();
        location.href = '../index.html';
      });

      // embed mode: hide back button
      if (new URLSearchParams(window.location.search).get('embed') === '1') {
        document.getElementById('btnBack').style.display = 'none';
      }

      // background particles
      const bgP = document.getElementById('bgP');
      for (let i = 0; i < 36; i++) {
        const d = document.createElement('div');
        d.className = 'bg-dot';
        d.style.left = Math.random() * 100 + '%';
        d.style.top = Math.random() * 100 + '%';
        d.style.setProperty('--dur', (4 + Math.random() * 6) + 's');
        d.style.setProperty('--dx', ((Math.random() - 0.5) * 70) + 'px');
        d.style.setProperty('--dy', ((Math.random() - 0.5) * 70) + 'px');
        d.style.animationDelay = (Math.random() * 5) + 's';
        bgP.appendChild(d);
      }

      // music
      const music = document.getElementById('alphabet-explorer-music');
      if (music) {
        music.volume = 0.45;
        setTimeout(() => { music.play().catch(() => {}); }, 600);
      }
    });

    // touch ripple effect
    document.addEventListener('touchstart', (e) => {
      for (let i = 0; i < e.changedTouches.length; i++) {
        const t = e.changedTouches[i];
        const ring = document.createElement('div');
        ring.className = 'touch-ring';
        ring.style.left = t.clientX + 'px';
        ring.style.top = t.clientY + 'px';
        document.body.appendChild(ring);
        ring.addEventListener('animationend', function() { this.remove(); });
      }
    }, { passive: true });

  </script>
</body>
</html>