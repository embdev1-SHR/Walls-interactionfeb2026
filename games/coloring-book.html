<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Jungle Coloring Wall</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-user-select:none;user-select:none}
body{
  font-family:'Comic Sans MS','Chalkboard SE','Arial Rounded MT Bold',cursive;
  background:linear-gradient(180deg,#1a4d2e 0%,#2d5f3f 50%,#1a3a2e 100%);
  overflow:hidden;touch-action:none;
}
.jungle-bg{position:fixed;inset:0;pointer-events:none;z-index:0}
.leaf{position:absolute;opacity:.12;font-size:70px;animation:sway 6s ease-in-out infinite}
@keyframes sway{0%,100%{transform:rotate(-5deg) translateX(0)}50%{transform:rotate(5deg) translateX(8px)}}

#canvas-container{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  z-index:1;
}
#coloring-canvas{
  background:rgba(255,255,255,.96);
  cursor:crosshair;position:absolute;
  top:50%;left:50%;transform-origin:center center;
}

.template-panel{
  position:fixed;right:12px;top:50%;transform:translateY(-50%);
  background:linear-gradient(135deg,#2ecc71,#27ae60);
  padding:14px 10px;border-radius:22px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
  display:flex;flex-direction:column;gap:10px;
  max-height:75vh;overflow-y:auto;z-index:1000;
  border:4px solid #fff;
}
.template-panel::-webkit-scrollbar{width:5px}
.template-panel::-webkit-scrollbar-thumb{background:rgba(255,255,255,.4);border-radius:5px}
.tpl-btn{
  width:64px;height:64px;border:3px solid #fff;border-radius:14px;
  cursor:pointer;transition:all .3s;
  background:linear-gradient(135deg,#fff,#f8f9fa);
  font-size:38px;display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 10px rgba(0,0,0,.15);
  touch-action:manipulation;-webkit-tap-highlight-color:transparent;
}
.tpl-btn:active{transform:scale(.9)}
.tpl-btn.active{border-color:#FF6347;border-width:4px;background:linear-gradient(135deg,#FFF9C4,#FFE082)}

.bottom-bar{
  position:fixed;bottom:0;left:0;right:0;
  display:flex;flex-direction:column;align-items:center;gap:8px;
  padding:8px 12px 14px;z-index:1000;
  background:linear-gradient(to top,rgba(0,0,0,.6),transparent);
}
.color-bar{
  display:flex;gap:6px;align-items:center;
  padding:10px 18px;
  background:linear-gradient(135deg,#ff6b35,#f7931e);
  border-radius:50px;border:4px solid #fff;
  box-shadow:0 8px 30px rgba(0,0,0,.3);
}
.color-swatch{
  width:44px;height:44px;border-radius:50%;
  border:3px solid #fff;cursor:pointer;
  transition:all .2s;box-shadow:0 4px 10px rgba(0,0,0,.25);
  touch-action:none;-webkit-tap-highlight-color:transparent;
  position:relative;flex-shrink:0;
}
.color-swatch:active{transform:scale(1.15)}
.color-swatch.active{
  border-color:#FFD700;border-width:4px;
  transform:scale(1.1);
  box-shadow:0 4px 18px rgba(255,215,0,.6);
}
.bar-divider{width:2px;height:32px;background:rgba(255,255,255,.4);border-radius:2px;flex-shrink:0}
.size-slider{
  width:80px;height:6px;border-radius:10px;
  background:linear-gradient(90deg,#ff6b35,#f7931e);
  outline:none;-webkit-appearance:none;flex-shrink:0;
}
.size-slider::-webkit-slider-thumb{
  -webkit-appearance:none;width:22px;height:22px;border-radius:50%;
  background:#fff;cursor:pointer;box-shadow:0 3px 8px rgba(0,0,0,.3);
  border:2px solid #FFD700;
}
.tool-btn{
  width:44px;height:44px;background:#fff;border:3px solid #fff;
  border-radius:50%;cursor:pointer;font-size:20px;
  transition:all .2s;box-shadow:0 4px 10px rgba(0,0,0,.15);
  touch-action:manipulation;-webkit-tap-highlight-color:transparent;flex-shrink:0;
}
.tool-btn:active{transform:scale(.9)}
.tool-btn.active{background:#90EE90;box-shadow:inset 0 3px 8px rgba(0,0,0,.2)}

.controls-row{
  display:flex;gap:10px;align-items:center;
}
.ctrl-btn{
  padding:8px 18px;background:rgba(255,255,255,.15);
  border:2px solid rgba(255,255,255,.3);border-radius:30px;
  color:white;font-size:13px;font-weight:700;
  cursor:pointer;transition:all .2s;backdrop-filter:blur(6px);
  touch-action:manipulation;-webkit-tap-highlight-color:transparent;
}
.ctrl-btn:active{transform:scale(.93)}

.pointer-dot{
  position:fixed;width:10px;height:10px;border-radius:50%;
  pointer-events:none;z-index:999;
  transform:translate(-50%,-50%);
  border:2px solid rgba(255,255,255,.8);
  transition:width .15s,height .15s;
}

.animal-label{
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:64px;color:#FFD700;
  text-shadow:3px 3px 6px rgba(0,0,0,.6);
  pointer-events:none;z-index:999;
  animation:fadeInOut 1.8s ease-in-out forwards;
}
@keyframes fadeInOut{
  0%,100%{opacity:0;transform:translate(-50%,-50%) scale(.5)}
  50%{opacity:1;transform:translate(-50%,-50%) scale(1)}
}
</style>
</head>
<body>
<div class="jungle-bg" id="jungleBg"></div>

<div id="canvas-container">
  <canvas id="coloring-canvas"></canvas>
</div>

<div class="template-panel" id="templatePanel"></div>

<div class="bottom-bar">
  <div class="color-bar" id="colorBar"></div>
  <div class="controls-row">
    <button class="ctrl-btn" id="clearBtn">&#128260; Clear</button>
    <button class="ctrl-btn" id="backBtn">Back to Menu</button>
  </div>
</div>

<script>
var canvas = document.getElementById('coloring-canvas');
var ctx = canvas.getContext('2d');
canvas.width = window.innerWidth * 2;
canvas.height = window.innerHeight * 2;

var COLORS = [
  '#FF6B6B','#FF1493','#FF6347','#FFA07A','#FFD700','#F7DC6F',
  '#4ECDC4','#45B7D1','#20B2AA','#98D8C8','#52B788','#BB8FCE',
  '#fff','#888','#333'
];

var currentColor = COLORS[0];
var brushSize = 25;
var isEraser = false;
var currentTemplate = 'elephant';
var scale = 1;
var offsetX = 0, offsetY = 0;

var activePointers = {};

ctx.lineCap = 'round';
ctx.lineJoin = 'round';

function buildColorBar() {
  var bar = document.getElementById('colorBar');
  bar.innerHTML = '';
  COLORS.forEach(function(c, i) {
    var sw = document.createElement('div');
    sw.className = 'color-swatch' + (c === currentColor && !isEraser ? ' active' : '');
    sw.style.background = c;
    if (c === '#fff') sw.style.border = '3px solid #ccc';
    sw.dataset.color = c;
    bar.appendChild(sw);
  });

  var div1 = document.createElement('div');
  div1.className = 'bar-divider';
  bar.appendChild(div1);

  var slider = document.createElement('input');
  slider.type = 'range';
  slider.className = 'size-slider';
  slider.min = 5; slider.max = 60; slider.value = brushSize;
  slider.id = 'brushSlider';
  bar.appendChild(slider);

  var div2 = document.createElement('div');
  div2.className = 'bar-divider';
  bar.appendChild(div2);

  var eraser = document.createElement('button');
  eraser.className = 'tool-btn' + (isEraser ? ' active' : '');
  eraser.textContent = '\uD83E\uDDFD';
  eraser.id = 'eraserBtn';
  bar.appendChild(eraser);
}

var templates = {
  elephant: { emoji: '\uD83D\uDC18', draw: drawElephant },
  lion: { emoji: '\uD83E\uDD81', draw: drawLion },
  monkey: { emoji: '\uD83D\uDC35', draw: drawMonkey },
  parrot: { emoji: '\uD83E\uDD9C', draw: drawParrot },
  snake: { emoji: '\uD83D\uDC0D', draw: drawSnake },
  tiger: { emoji: '\uD83D\uDC2F', draw: drawTiger },
  giraffe: { emoji: '\uD83E\uDD92', draw: drawGiraffe },
  frog: { emoji: '\uD83D\uDC38', draw: drawFrog }
};

function buildTemplatePanel() {
  var panel = document.getElementById('templatePanel');
  panel.innerHTML = '';
  Object.keys(templates).forEach(function(key) {
    var btn = document.createElement('button');
    btn.className = 'tpl-btn' + (key === currentTemplate ? ' active' : '');
    btn.textContent = templates[key].emoji;
    btn.dataset.template = key;
    panel.appendChild(btn);
  });
}

function clearCanvas() {
  ctx.fillStyle = 'white';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  templates[currentTemplate].draw();
}

function applyTransform() {
  canvas.style.transform = 'translate(calc(-50% + ' + offsetX + 'px), calc(-50% + ' + offsetY + 'px)) scale(' + scale + ')';
}

function getCanvasCoords(cx, cy) {
  var rect = canvas.getBoundingClientRect();
  return { x: (cx - rect.left) / scale, y: (cy - rect.top) / scale };
}

function drawStroke(fromX, fromY, toX, toY, color, size) {
  ctx.lineWidth = size;
  ctx.strokeStyle = color;
  ctx.globalCompositeOperation = 'source-over';
  ctx.beginPath();
  ctx.moveTo(fromX, fromY);
  ctx.lineTo(toX, toY);
  ctx.stroke();
}

function handlePointerDown(e) {
  e.preventDefault();
  var target = e.target;

  if (target.classList && target.classList.contains('color-swatch')) {
    currentColor = target.dataset.color;
    isEraser = false;
    document.querySelectorAll('.color-swatch').forEach(function(s) { s.classList.remove('active') });
    target.classList.add('active');
    var eb = document.getElementById('eraserBtn');
    if (eb) eb.classList.remove('active');
    return;
  }
  if (target.id === 'eraserBtn') {
    isEraser = !isEraser;
    target.classList.toggle('active');
    if (isEraser) document.querySelectorAll('.color-swatch').forEach(function(s) { s.classList.remove('active') });
    return;
  }
  if (target.classList && target.classList.contains('tpl-btn')) {
    currentTemplate = target.dataset.template;
    document.querySelectorAll('.tpl-btn').forEach(function(b) { b.classList.remove('active') });
    target.classList.add('active');
    clearCanvas();
    var label = document.createElement('div');
    label.className = 'animal-label';
    label.textContent = templates[currentTemplate].emoji;
    document.body.appendChild(label);
    setTimeout(function() { label.remove() }, 1800);
    return;
  }

  if (target !== canvas) return;

  var coords = getCanvasCoords(e.clientX, e.clientY);
  activePointers[e.pointerId] = { x: coords.x, y: coords.y, color: isEraser ? 'white' : currentColor };

  var dot = document.getElementById('pdot-' + e.pointerId);
  if (!dot) {
    dot = document.createElement('div');
    dot.className = 'pointer-dot';
    dot.id = 'pdot-' + e.pointerId;
    document.body.appendChild(dot);
  }
  dot.style.left = e.clientX + 'px';
  dot.style.top = e.clientY + 'px';
  dot.style.background = activePointers[e.pointerId].color;
  dot.style.width = Math.min(brushSize, 30) + 'px';
  dot.style.height = Math.min(brushSize, 30) + 'px';
}

function handlePointerMove(e) {
  e.preventDefault();
  if (!activePointers[e.pointerId]) return;

  var prev = activePointers[e.pointerId];
  var coords = getCanvasCoords(e.clientX, e.clientY);
  drawStroke(prev.x, prev.y, coords.x, coords.y, prev.color, brushSize);
  activePointers[e.pointerId].x = coords.x;
  activePointers[e.pointerId].y = coords.y;

  var dot = document.getElementById('pdot-' + e.pointerId);
  if (dot) { dot.style.left = e.clientX + 'px'; dot.style.top = e.clientY + 'px'; }
}

function handlePointerUp(e) {
  delete activePointers[e.pointerId];
  var dot = document.getElementById('pdot-' + e.pointerId);
  if (dot) dot.remove();
  ctx.beginPath();
}

document.addEventListener('pointerdown', handlePointerDown);
document.addEventListener('pointermove', handlePointerMove);
document.addEventListener('pointerup', handlePointerUp);
document.addEventListener('pointercancel', handlePointerUp);

document.getElementById('colorBar').addEventListener('input', function(e) {
  if (e.target.id === 'brushSlider') brushSize = parseInt(e.target.value);
});

function addTouchBtn(id, fn) {
  var el = document.getElementById(id);
  if (!el) return;
  el.addEventListener('click', function(e) { if (!(e.sourceCapabilities && e.sourceCapabilities.firesTouchEvents)) fn() });
  el.addEventListener('touchend', function(e) { e.preventDefault(); e.stopPropagation(); fn() });
}

addTouchBtn('clearBtn', function() { clearCanvas() });
addTouchBtn('backBtn', function() { location.href = '../index.html' });

var bg = document.getElementById('jungleBg');
var bgEmojis = ['\uD83C\uDF3F', '\uD83C\uDF43', '\uD83C\uDF34', '\uD83C\uDF3A'];
for (var i = 0; i < 15; i++) {
  var leaf = document.createElement('div');
  leaf.className = 'leaf';
  leaf.textContent = bgEmojis[Math.floor(Math.random() * bgEmojis.length)];
  leaf.style.left = Math.random() * 100 + '%';
  leaf.style.top = Math.random() * 100 + '%';
  leaf.style.animationDelay = Math.random() * 6 + 's';
  bg.appendChild(leaf);
}

function drawElephant() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 50, 180, 150, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx, cy - 120, 130, 120, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx - 150, cy - 120, 70, 100, -0.3, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 150, cy - 120, 70, 100, 0.3, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(cx, cy - 60); ctx.quadraticCurveTo(cx - 50, cy + 50, cx - 40, cy + 150);
  ctx.quadraticCurveTo(cx - 30, cy + 180, cx - 10, cy + 190); ctx.quadraticCurveTo(cx + 10, cy + 180, cx + 20, cy + 150);
  ctx.quadraticCurveTo(cx + 30, cy + 50, cx, cy - 60); ctx.fill(); ctx.stroke();
  for (var i = 0; i < 4; i++) { var lx = cx - 100 + i * 70; ctx.fillRect(lx - 25, cy + 150, 50, 120); ctx.strokeRect(lx - 25, cy + 150, 50, 120); }
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 50, cy - 140, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 50, cy - 140, 15, 0, Math.PI * 2); ctx.fill();
}

function drawLion() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  for (var i = 0; i < 16; i++) { var a = (i / 16) * Math.PI * 2; ctx.beginPath(); ctx.arc(cx + Math.cos(a) * 140, cy - 80 + Math.sin(a) * 140, 50, 0, Math.PI * 2); ctx.fill(); ctx.stroke(); }
  ctx.beginPath(); ctx.ellipse(cx, cy - 80, 110, 100, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx, cy + 80, 140, 120, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  for (var i = 0; i < 4; i++) { var lx = cx - 90 + i * 60; ctx.fillRect(lx - 20, cy + 150, 40, 110); ctx.strokeRect(lx - 20, cy + 150, 40, 110); }
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 40, cy - 90, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 40, cy - 90, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.moveTo(cx, cy - 50); ctx.lineTo(cx - 15, cy - 30); ctx.lineTo(cx + 15, cy - 30); ctx.closePath(); ctx.fill();
}

function drawMonkey() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 20, 120, 140, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.arc(cx, cy - 120, 100, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.arc(cx - 90, cy - 120, 40, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.arc(cx + 90, cy - 120, 40, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx, cy - 100, 60, 70, 0, 0, Math.PI * 2); ctx.fillStyle = '#FFE5CC'; ctx.fill(); ctx.fillStyle = 'white'; ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx - 130, cy + 50, 30, 100, -0.3, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 130, cy + 50, 30, 100, 0.3, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 30, cy - 110, 12, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 30, cy - 110, 12, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx, cy - 90, 30, 0.2, Math.PI - 0.2); ctx.stroke();
}

function drawParrot() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 30, 100, 130, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.arc(cx, cy - 80, 80, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.fillStyle = '#FFD700';
  ctx.beginPath(); ctx.moveTo(cx + 40, cy - 70); ctx.quadraticCurveTo(cx + 100, cy - 60, cx + 90, cy - 40); ctx.lineTo(cx + 50, cy - 50); ctx.closePath(); ctx.fill(); ctx.stroke();
  ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx - 80, cy + 20, 50, 100, -0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 80, cy + 20, 50, 100, 0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  for (var i = 0; i < 5; i++) { ctx.beginPath(); ctx.ellipse(cx - 40 + i * 20, cy + 160, 20, 80, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke(); }
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx + 20, cy - 90, 12, 0, Math.PI * 2); ctx.fill();
}

function drawSnake() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.moveTo(cx, cy - 200);
  for (var i = 0; i < 5; i++) { var y = cy - 200 + i * 70; ctx.bezierCurveTo(cx + 150, y + 20, cx + 150, y + 50, cx, y + 70); ctx.bezierCurveTo(cx - 150, y + 90, cx - 150, y + 120, cx, y + 140); }
  ctx.lineWidth = 80; ctx.stroke(); ctx.lineWidth = 6;
  ctx.beginPath(); ctx.ellipse(cx, cy - 240, 70, 60, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 25, cy - 250, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 25, cy - 250, 15, 0, Math.PI * 2); ctx.fill();
  ctx.strokeStyle = '#FF1493'; ctx.lineWidth = 4;
  ctx.beginPath(); ctx.moveTo(cx, cy - 200); ctx.lineTo(cx - 10, cy - 160); ctx.moveTo(cx, cy - 200); ctx.lineTo(cx + 10, cy - 160); ctx.stroke();
}

function drawTiger() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 50, 160, 130, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx, cy - 100, 120, 110, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  for (var i = 0; i < 4; i++) { var lx = cx - 100 + i * 70; ctx.fillRect(lx - 20, cy + 130, 40, 120); ctx.strokeRect(lx - 20, cy + 130, 40, 120); }
  for (var i = 0; i < 6; i++) { ctx.beginPath(); ctx.moveTo(cx - 120, cy + 20 + i * 25); ctx.lineTo(cx + 120, cy + 20 + i * 25); ctx.lineWidth = 15; ctx.stroke(); ctx.lineWidth = 6; }
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 40, cy - 110, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 40, cy - 110, 15, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.moveTo(cx, cy - 70); ctx.lineTo(cx - 15, cy - 50); ctx.lineTo(cx + 15, cy - 50); ctx.closePath(); ctx.fill();
}

function drawGiraffe() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 100, 140, 120, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.fillRect(cx - 30, cy - 300, 60, 400); ctx.strokeRect(cx - 30, cy - 300, 60, 400);
  ctx.beginPath(); ctx.ellipse(cx, cy - 330, 60, 50, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  for (var i = 0; i < 4; i++) { var lx = cx - 90 + i * 60; ctx.fillRect(lx - 15, cy + 180, 30, 150); ctx.strokeRect(lx - 15, cy + 180, 30, 150); }
  var spots = [[cx - 80, cy + 80], [cx - 40, cy + 60], [cx, cy + 100], [cx + 40, cy + 70], [cx + 80, cy + 90], [cx - 20, cy - 100], [cx + 10, cy - 150]];
  spots.forEach(function(s) { ctx.beginPath(); ctx.ellipse(s[0], s[1], 25, 30, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke(); });
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx + 20, cy - 340, 12, 0, Math.PI * 2); ctx.fill();
}

function drawFrog() {
  var cx = canvas.width / 2, cy = canvas.height / 2;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 6; ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.ellipse(cx, cy + 30, 130, 110, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx, cy - 50, 120, 80, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx - 60, cy - 90, 45, 50, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 60, cy - 90, 45, 50, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.fillStyle = '#333';
  ctx.beginPath(); ctx.arc(cx - 60, cy - 85, 20, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx + 60, cy - 85, 20, 0, Math.PI * 2); ctx.fill();
  ctx.fillStyle = 'white';
  ctx.beginPath(); ctx.arc(cx, cy - 20, 60, 0.1, Math.PI - 0.1); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx - 110, cy + 80, 30, 60, -0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 110, cy + 80, 30, 60, 0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx - 130, cy + 20, 50, 80, -0.8, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
  ctx.beginPath(); ctx.ellipse(cx + 130, cy + 20, 50, 80, 0.8, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
}

buildColorBar();
buildTemplatePanel();
clearCanvas();
applyTransform();

canvas.addEventListener('wheel', function(e) {
  e.preventDefault();
  var zf = e.deltaY > 0 ? 0.9 : 1.1;
  scale = Math.max(0.3, Math.min(3, scale * zf));
  applyTransform();
});

window.addEventListener('resize', function() {
  var tmp = document.createElement('canvas');
  var tmpCtx = tmp.getContext('2d');
  tmp.width = canvas.width; tmp.height = canvas.height;
  tmpCtx.drawImage(canvas, 0, 0);
  canvas.width = window.innerWidth * 2;
  canvas.height = window.innerHeight * 2;
  ctx.drawImage(tmp, 0, 0);
  applyTransform();
});
</script>
</body>
</html>
