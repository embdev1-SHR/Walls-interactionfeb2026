<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Solar System Explorer - Auto Rotate</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: #000;
            color: white;
            user-select: none;
        }

        #canvas-container { width: 100vw; height: 100vh; }

        /* --- UI Overlay --- */
        #info-panel {
            position: absolute;
            top: 50%;
            left: 30px;
            transform: translateY(-50%) translateX(-50px);
            width: 350px;
            max-width: 90vw;
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            pointer-events: none;
            z-index: 10;
        }

        #info-panel.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
            pointer-events: auto;
        }

        #info-panel h2 {
            font-size: 42px;
            font-weight: 800;
            color: #6fb1fc;
            text-shadow: 0 0 30px rgba(111, 177, 252, 0.6);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        #info-panel p {
            background: rgba(10, 20, 40, 0.85);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(111, 177, 252, 0.4);
            backdrop-filter: blur(12px);
            line-height: 1.6;
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }

        .stat {
            background: rgba(10, 20, 40, 0.7);
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-left: 3px solid #6fb1fc;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: space-between;
        }

        .stat strong { color: #6fb1fc; }

        /* --- Controls --- */
        #controls {
            position: absolute;
            bottom: 20px; right: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        button {
            width: 45px; height: 45px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(40, 40, 40, 0.8);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }
        button:hover { background: #6fb1fc; border-color: #6fb1fc; transform: translateY(-3px); }

        /* --- Menu Toggle --- */
        #planet-menu-toggle {
            position: absolute;
            top: 20px; right: 20px;
            background: rgba(0,0,0,0.6);
            padding: 12px 20px;
            border-radius: 30px;
            border: 1px solid rgba(111, 177, 252, 0.3);
            cursor: pointer;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
            z-index: 100;
        }
        #planet-menu-toggle:hover { border-color: #6fb1fc; background: rgba(0,0,0,0.8); }

        #planet-menu {
            position: absolute;
            top: 75px; right: 20px;
            background: rgba(5, 10, 20, 0.95);
            border: 1px solid rgba(111, 177, 252, 0.3);
            border-radius: 15px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            backdrop-filter: blur(15px);
            transform-origin: top right;
            transform: scale(0.9);
            opacity: 0;
            pointer-events: none;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 99;
        }

        #planet-menu.open {
            transform: scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .planet-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            color: #ddd;
        }
        .planet-item:hover { background: rgba(255,255,255,0.15); color: white; transform: translateX(-5px); }
        .planet-item.active { background: rgba(111, 177, 252, 0.25); color: #6fb1fc; border: 1px solid rgba(111, 177, 252, 0.4); }

        .planet-icon { width: 24px; height: 24px; border-radius: 50%; box-shadow: 0 0 8px rgba(255,255,255,0.3); }

        #loading {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px; color: #6fb1fc;
            background: rgba(0,0,0,0.85); padding: 40px; border-radius: 20px;
            border: 1px solid #6fb1fc;
            z-index: 200;
        }
        
        #title {
            position: absolute; top: 20px; left: 20px;
            background: rgba(0,0,0,0.5); padding: 12px 25px;
            border-radius: 30px; border: 1px solid rgba(255,255,255,0.2);
            pointer-events: none; z-index: 50;
        }
    </style>
</head>
<body>

    <div id="canvas-container"></div>
    <div class="loading" id="loading">Ignition Sequence Start...</div>

    <div id="title">
        <h1 style="font-size: 1.2rem; color: #fff; text-shadow: 0 0 10px rgba(111,177,252,0.5);">ðŸŒŒ Solar System Explorer</h1>
    </div>

    <div id="planet-menu-toggle">
        <span>Planets</span>
        <span>â–¼</span>
    </div>

    <div id="planet-menu">
        <div class="planet-item" data-planet="sun"><div class="planet-icon" style="background:#ffaa00"></div>Sun</div>
        <div class="planet-item" data-planet="mercury"><div class="planet-icon" style="background:#8c7853"></div>Mercury</div>
        <div class="planet-item" data-planet="venus"><div class="planet-icon" style="background:#ffc649"></div>Venus</div>
        <div class="planet-item" data-planet="earth"><div class="planet-icon" style="background:#4a90e2"></div>Earth</div>
        <div class="planet-item" data-planet="mars"><div class="planet-icon" style="background:#e27b58"></div>Mars</div>
        <div class="planet-item" data-planet="jupiter"><div class="planet-icon" style="background:#d8ca9d"></div>Jupiter</div>
        <div class="planet-item" data-planet="saturn"><div class="planet-icon" style="background:#fad5a5"></div>Saturn</div>
        <div class="planet-item" data-planet="uranus"><div class="planet-icon" style="background:#4fd0e7"></div>Uranus</div>
        <div class="planet-item" data-planet="neptune"><div class="planet-icon" style="background:#4166f5"></div>Neptune</div>
    </div>

    <div id="info-panel">
        <h2>Planet Name</h2>
        <p>Description goes here.</p>
        <div id="stats-container"></div>
    </div>

    <div id="controls">
        <button id="reset-view" title="Reset Camera">â†»</button>
        <button id="fullscreen-btn" title="Fullscreen">â›¶</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- Configuration ---
        const planetData = {
            sun: { 
                size: 12, distance: 0, speed: 0.002, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_sun.jpg',
                name: "The Sun",
                description: "The star at the center of our Solar System. Its gravity holds the system together.",
                facts: ["Type: Yellow Dwarf", "Surface Temp: 5,500Â°C", "Mass: 99.86% of Solar System"],
                color: 0xffaa00, glow: 0xff4400
            },
            mercury: { 
                size: 1.2, distance: 25, speed: 0.004, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_mercury.jpg',
                name: "Mercury",
                description: "The smallest planet in our solar system and closest to the Sun.",
                facts: ["Orbit: 88 days", "Day: 59 Earth days", "Temp: -180Â°C to 430Â°C"],
                color: 0xaaaaaa
            },
            venus: { 
                size: 1.8, distance: 35, speed: 0.003, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_venus.jpg',
                name: "Venus",
                description: "Second planet from the Sun. It has a thick, toxic atmosphere that traps heat.",
                facts: ["Orbit: 225 days", "Temp: 471Â°C", "Rotation: Retrograde (Backwards)"],
                color: 0xeecfa1
            },
            earth: { 
                size: 2.2, distance: 48, speed: 0.002, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_earth_daymap.jpg',
                name: "Earth",
                description: "Our home planet. The only place we know of so far that's inhabited by living things.",
                facts: ["Orbit: 365.25 days", "Moons: 1", "Surface: 71% Water"],
                color: 0x2233ff
            },
            mars: { 
                size: 1.5, distance: 62, speed: 0.0018, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_mars.jpg',
                name: "Mars",
                description: "The Red Planet. It's a dusty, cold, desert world with a very thin atmosphere.",
                facts: ["Orbit: 687 days", "Moons: 2", "Gravity: 38% of Earth"],
                color: 0xff4422
            },
            jupiter: { 
                size: 6.5, distance: 85, speed: 0.001, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_jupiter.jpg',
                name: "Jupiter",
                description: "A gas giant and the largest planet in our solar system.",
                facts: ["Orbit: 12 years", "Moons: 79+", "Day: 10 hours"],
                color: 0xd8ca9d
            },
            saturn: { 
                size: 5.5, distance: 110, speed: 0.0008, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_saturn.jpg',
                ringUrl: 'https://www.solarsystemscope.com/textures/download/2k_saturn_ring_alpha.png',
                name: "Saturn",
                description: "Adorned with a dazzling, complex system of icy rings.",
                facts: ["Orbit: 29 years", "Moons: 82", "Type: Gas Giant"],
                color: 0xf4d0a9, hasRings: true
            },
            uranus: { 
                size: 3.8, distance: 135, speed: 0.0006, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_uranus.jpg',
                name: "Uranus",
                description: "An ice giant that rotates at a nearly 90-degree angle from the plane of its orbit.",
                facts: ["Orbit: 84 years", "Temp: -224Â°C", "Moons: 27"],
                color: 0x77ddff
            },
            neptune: { 
                size: 3.6, distance: 155, speed: 0.0005, 
                textureUrl: '3dmodels/solarsystem/Textures/2k_neptune.jpg',
                name: "Neptune",
                description: "Dark, cold and whipped by supersonic winds. It is the last of the planets.",
                facts: ["Orbit: 165 years", "Winds: 2,100 km/h", "Moons: 14"],
                color: 0x3355ff
            }
        };

        // --- Init Scene ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x020205); 
        scene.fog = new THREE.FogExp2(0x020205, 0.001);

        const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 2000);
        camera.position.set(0, 90, 240);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.maxDistance = 600;
        
        // --- AUTO ROTATE SETUP ---
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.5; // Slow, cinematic rotation

        // --- LIGHTING ---
        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6); 
        scene.add(hemiLight);

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.4); 
        scene.add(ambientLight);

        const sunLight = new THREE.PointLight(0xffffff, 3.0, 800, 1);
        sunLight.position.set(0, 0, 0);
        sunLight.castShadow = true;
        sunLight.shadow.mapSize.width = 2048;
        sunLight.shadow.mapSize.height = 2048;
        sunLight.shadow.bias = -0.0001;
        scene.add(sunLight);

        // --- STARS ---
        function createStars() {
            const geometry = new THREE.BufferGeometry();
            const count = 18000;
            const pos = new Float32Array(count * 3);
            const sizes = new Float32Array(count);
            const colors = new Float32Array(count * 3);

            const colorOptions = [
                new THREE.Color(0xffffff),
                new THREE.Color(0xaaccff), 
                new THREE.Color(0xffccaa)  
            ];

            for(let i=0; i<count; i++) {
                pos[i*3] = (Math.random()-0.5) * 2500;
                pos[i*3+1] = (Math.random()-0.5) * 2500;
                pos[i*3+2] = (Math.random()-0.5) * 2500;
                sizes[i] = Math.random() * 2.0; 
                
                const col = colorOptions[Math.floor(Math.random() * colorOptions.length)];
                colors[i*3] = col.r;
                colors[i*3+1] = col.g;
                colors[i*3+2] = col.b;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            const material = new THREE.PointsMaterial({
                size: 1, 
                sizeAttenuation: true, 
                vertexColors: true,
                transparent: true, 
                opacity: 0.9
            });

            const stars = new THREE.Points(geometry, material);
            scene.add(stars);
        }
        createStars();

        // --- Helpers ---
        function createOrbit(radius) {
            const geometry = new THREE.RingGeometry(radius - 0.2, radius + 0.2, 128);
            const material = new THREE.MeshBasicMaterial({ color: 0xffffff, opacity: 0.15, transparent: true, side: THREE.DoubleSide });
            const mesh = new THREE.Mesh(geometry, material);
            mesh.rotation.x = -Math.PI / 2;
            scene.add(mesh);
        }

        function createSunGlow(size, color) {
            const spriteMaterial = new THREE.SpriteMaterial({ 
                map: new THREE.TextureLoader().load('https://threejs.org/examples/textures/sprites/glow.png'), 
                color: color, 
                transparent: true, 
                blending: THREE.AdditiveBlending,
                opacity: 1.0
            });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.scale.set(size * 4.5, size * 4.5, 1.0);
            return sprite;
        }

        // --- Load Planets ---
        const planets = {};
        const planetMeshes = [];
        const loader = new THREE.TextureLoader();
        let loaded = 0;
        const total = Object.keys(planetData).length;

        Object.entries(planetData).forEach(([key, data]) => {
            const group = new THREE.Group();
            group.userData = { key, ...data };
            
            if(data.distance > 0) createOrbit(data.distance);

            const angle = Math.random() * Math.PI * 2;
            group.userData.angle = angle;
            group.position.set(Math.cos(angle) * data.distance, 0, Math.sin(angle) * data.distance);

            loader.load(data.textureUrl, (tex) => {
                const geom = new THREE.SphereGeometry(data.size, 64, 64);
                let mat;

                if (key === 'sun') {
                    mat = new THREE.MeshBasicMaterial({ map: tex });
                    const glow = createSunGlow(data.size, data.glow);
                    group.add(glow);
                } else {
                    mat = new THREE.MeshStandardMaterial({ 
                        map: tex, 
                        roughness: 0.6,
                        metalness: 0.1
                    });
                }

                const mesh = new THREE.Mesh(geom, mat);
                mesh.userData = { parentKey: key };
                
                if (key !== 'sun') {
                    mesh.castShadow = true;
                    mesh.receiveShadow = true;
                }

                group.add(mesh);
                planetMeshes.push(mesh);

                if (key === 'earth') {
                    const atmoGeom = new THREE.SphereGeometry(data.size * 1.03, 64, 64);
                    const atmoMat = new THREE.MeshPhongMaterial({
                        color: 0x00aaff, transparent: true, opacity: 0.25, side: THREE.BackSide,
                        blending: THREE.AdditiveBlending
                    });
                    group.add(new THREE.Mesh(atmoGeom, atmoMat));
                }

                if (data.hasRings) {
                    loader.load(data.ringUrl, (ringTex) => {
                        const ringGeom = new THREE.RingGeometry(data.size * 1.4, data.size * 2.4, 64);
                        const ringMat = new THREE.MeshStandardMaterial({ 
                            map: ringTex, side: THREE.DoubleSide, transparent: true, opacity: 0.85 
                        });
                        const rings = new THREE.Mesh(ringGeom, ringMat);
                        rings.rotation.x = -Math.PI / 2;
                        rings.receiveShadow = true;
                        group.add(rings);
                    });
                }

                scene.add(group);
                planets[key] = group;
                checkLoad();

            }, undefined, () => {
                const geom = new THREE.SphereGeometry(data.size, 32, 32);
                const mat = new THREE.MeshStandardMaterial({ color: data.color });
                const mesh = new THREE.Mesh(geom, mat);
                mesh.userData = { parentKey: key };
                group.add(mesh);
                planetMeshes.push(mesh);
                scene.add(group);
                planets[key] = group;
                checkLoad();
            });
        });

        function checkLoad() {
            loaded++;
            if (loaded === total) document.getElementById('loading').style.display = 'none';
        }

        // --- Camera Logic ---
        let focusTarget = null;
        let cameraOffset = new THREE.Vector3(0, 10, 20);

        function focusOnPlanet(key) {
            // STOP auto rotate when focusing
            controls.autoRotate = false;
            
            focusTarget = planets[key];
            const data = planetData[key];

            const dist = data.size * 4 + 10;
            cameraOffset.set(0, data.size * 1.5, dist);

            document.querySelectorAll('.planet-item').forEach(el => el.classList.remove('active'));
            document.querySelector(`.planet-item[data-planet="${key}"]`)?.classList.add('active');
            
            const panel = document.getElementById('info-panel');
            panel.classList.remove('visible');
            setTimeout(() => {
                panel.querySelector('h2').innerText = data.name;
                panel.querySelector('p').innerText = data.description;
                const stats = document.getElementById('stats-container');
                stats.innerHTML = data.facts.map(f => {
                    const [l, v] = f.split(':');
                    return `<div class="stat"><strong>${l}:</strong> <span>${v}</span></div>`;
                }).join('');
                panel.classList.add('visible');
            }, 300);
        }

        // --- Interaction ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        window.addEventListener('mousemove', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        });

        window.addEventListener('click', (event) => {
            if (event.target.closest('#planet-menu') || event.target.closest('#planet-menu-toggle') || event.target.closest('#controls')) return;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(planetMeshes);

            if (intersects.length > 0) {
                const key = intersects[0].object.userData.parentKey;
                if (key) focusOnPlanet(key);
            }
        });

        document.querySelectorAll('.planet-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.stopPropagation();
                focusOnPlanet(item.dataset.planet);
                document.getElementById('planet-menu').classList.remove('open');
            });
        });

        document.getElementById('planet-menu-toggle').addEventListener('click', () => {
            document.getElementById('planet-menu').classList.toggle('open');
        });

        document.getElementById('reset-view').addEventListener('click', () => {
            focusTarget = null;
            
            // RE-ENABLE auto rotate when resetting
            controls.autoRotate = true;

            const startPos = camera.position.clone();
            const endPos = new THREE.Vector3(0, 90, 240);
            let t = 0;
            const animateReset = () => {
                t += 0.05;
                if (t <= 1) {
                    camera.position.lerpVectors(startPos, endPos, 0.1);
                    controls.target.lerp(new THREE.Vector3(0,0,0), 0.1);
                    requestAnimationFrame(animateReset);
                }
            };
            animateReset();

            document.getElementById('info-panel').classList.remove('visible');
            document.querySelectorAll('.planet-item').forEach(el => el.classList.remove('active'));
        });

        document.getElementById('fullscreen-btn').addEventListener('click', () => {
            if(!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(planetMeshes);
            document.body.style.cursor = intersects.length > 0 ? 'pointer' : 'default';

            Object.values(planets).forEach(group => {
                const data = group.userData;
                group.children.forEach(child => child.rotation.y += 0.005);
                if (data.distance > 0) {
                    data.angle += data.speed;
                    group.position.x = Math.cos(data.angle) * data.distance;
                    group.position.z = Math.sin(data.angle) * data.distance;
                }
            });

            if (focusTarget) {
                const targetPos = focusTarget.position.clone();
                const offset = cameraOffset.clone();
                const camPos = targetPos.clone().add(offset);
                camera.position.lerp(camPos, 0.05);
                controls.target.lerp(targetPos, 0.05);
            }

            controls.update();
            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>